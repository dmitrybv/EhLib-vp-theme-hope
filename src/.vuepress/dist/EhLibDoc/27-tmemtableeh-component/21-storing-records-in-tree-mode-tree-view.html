<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.53" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/21-storing-records-in-tree-mode-tree-view.html"><meta property="og:site_name" content="EhLib.VCL Developerâ€™s guide"><meta property="og:title" content="Storing records in tree mode (TreeView)"><meta property="og:description" content="In tree mode the TMemTableEh create node objects (TMemRecViewEh type) for each record in the internal array. Node object have reference to parent record (Rec property) and has a..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><link rel="icon" href="/online-help-vuepress-hope/favicon.ico"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/online-help-vuepress-hope/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/online-help-vuepress-hope/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/online-help-vuepress-hope/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>Storing records in tree mode (TreeView) | EhLib.VCL Developerâ€™s guide</title><meta name="description" content="In tree mode the TMemTableEh create node objects (TMemRecViewEh type) for each record in the internal array. Node object have reference to parent record (Rec property) and has a...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/online-help-vuepress-hope/assets/style.c7186ee6.css" as="style" /><link rel="stylesheet" href="/online-help-vuepress-hope/assets/style.c7186ee6.css" />
    <link rel="modulepreload" href="/online-help-vuepress-hope/assets/app.ac77cf73.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/21-storing-records-in-tree-mode-tree-view.html.1018567b.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/21-storing-records-in-tree-mode-tree-view.html.e6ca3f4e.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/online-help-vuepress-hope/" class="brand"><img class="logo" src="/online-help-vuepress-hope/EhLib.Logo.Text.png" alt="EhLib.VCL Developerâ€™s guide"><!----><span class="site-name hide-in-pad">EhLib.VCL Developerâ€™s guide</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!----><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><!----><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><div class="search-pro-button" role="search" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg></div><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading clickable active"><!----><a href="/online-help-vuepress-hope/EhLibDoc/" class="title"></a><!----></p><ul class="sidebar-links"><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/00-content.html" class="nav-link sidebar-link sidebar-page" aria-label="Content"><!---->Content<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/01-introduction.html" class="nav-link sidebar-link sidebar-page" aria-label="Introduction"><!---->Introduction<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/02-specifications.html" class="nav-link sidebar-link sidebar-page" aria-label="Specification"><!---->Specification<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/03-installing.html" class="nav-link sidebar-link sidebar-page" aria-label="Installing"><!---->Installing<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/04-list-of-components-and-classes.html" class="nav-link sidebar-link sidebar-page" aria-label="List of components and classes"><!---->List of components and classes<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html" class="nav-link sidebar-link sidebar-page" aria-label="Language resources"><!---->Language resources<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDBGridEh Component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TPrintDBGridEh component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDBVertGridEh component</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/13-using-tdbsumlist-component.html" class="nav-link sidebar-link sidebar-page" aria-label="Using TDBSumList component"><!---->Using TDBSumList component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Edit controls</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html" class="nav-link sidebar-link sidebar-page" aria-label="DropDownForms - custom drop-down windows"><!---->DropDownForms - custom drop-down windows<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/21-printing-components-of-library.html" class="nav-link sidebar-link sidebar-page" aria-label="Printing components of Library"><!---->Printing components of Library<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/22-export-library-components-to-pdf-file.html" class="nav-link sidebar-link sidebar-page" aria-label="Export library components to Pdf file"><!---->Export library components to Pdf file<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/23-generating-pdf-files-using-the-printer-class.html" class="nav-link sidebar-link sidebar-page" aria-label="Generating Pdf Files Using the Printer Class"><!---->Generating Pdf Files Using the Printer Class<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/24-view-properties-of-components-at-run-time.html" class="nav-link sidebar-link sidebar-page" aria-label="View properties of components at Run-Time"><!---->View properties of components at Run-Time<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/25-using-tpropstorageeh-components.html" class="nav-link sidebar-link sidebar-page" aria-label="TPropStorageEh component"><!---->TPropStorageEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/26-mem-table-and-data-driver.html" class="nav-link sidebar-link sidebar-page" aria-label="MemTable and DataDriver"><!---->MemTable and DataDriver<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-stack"></span><span class="title">TMemTableEh component</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/01-tmemtableeh-component.html" class="nav-link sidebar-link sidebar-page" aria-label="TMemTableEh component"><!---->TMemTableEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/02-two-working-mode-of-tmemtableeh.html" class="nav-link sidebar-link sidebar-page" aria-label="Two working mode of TMemTableEh component"><!---->Two working mode of TMemTableEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/03-view-scroll.html" class="nav-link sidebar-link sidebar-page" aria-label="ViewScroll"><!---->ViewScroll<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/04-master-detail-relations.html" class="nav-link sidebar-link sidebar-page" aria-label="Master/detail relations"><!---->Master/detail relations<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/05-working-with-auto-increment-fields.html" class="nav-link sidebar-link sidebar-page" aria-label="Working with AutoIncrement fields"><!---->Working with AutoIncrement fields<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/06-using-indexes.html" class="nav-link sidebar-link sidebar-page" aria-label="Using indexes"><!---->Using indexes<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/07-shared-array-of-records.html" class="nav-link sidebar-link sidebar-page" aria-label="Using shared array of records by several TMemTableEhâ€™s"><!---->Using shared array of records by several TMemTableEhâ€™s<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/08-moving-records-in-grid.html" class="nav-link sidebar-link sidebar-page" aria-label="Moving records in TMemTableEh when dghRecordMoving mode is active"><!---->Moving records in TMemTableEh when dghRecordMoving mode is active<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/09-trefobjectfield-field.html" class="nav-link sidebar-link sidebar-page" aria-label="TRefObjectField field type"><!---->TRefObjectField field type<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/10-maintained-aggregates.html" class="nav-link sidebar-link sidebar-page" aria-label="Using maintained aggregates"><!---->Using maintained aggregates<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/11-records-sorting.html" class="nav-link sidebar-link sidebar-page" aria-label="Records sorting"><!---->Records sorting<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/12-creation-removing-data-stand-alone-mode.html" class="nav-link sidebar-link sidebar-page" aria-label="Creation/removing table data in memory in the â€˜stand-aloneâ€™ mode"><!---->Creation/removing table data in memory in the â€˜stand-aloneâ€™ mode<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/13-memtableeh-in-datadriver-mode.html" class="nav-link sidebar-link sidebar-page" aria-label="Working with MemTableEh in the &#39;with datadriver&#39; mode"><!---->Working with MemTableEh in the &#39;with datadriver&#39; mode<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/14-bookmarking.html" class="nav-link sidebar-link sidebar-page" aria-label="Marking and Returning to Records"><!---->Marking and Returning to Records<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/15-cached-updates.html" class="nav-link sidebar-link sidebar-page" aria-label="Cached updates"><!---->Cached updates<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/16-searching-in-tmemtableeh.html" class="nav-link sidebar-link sidebar-page" aria-label="Searching in TMemTableEh"><!---->Searching in TMemTableEh<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/17-access-record-values.html" class="nav-link sidebar-link sidebar-page" aria-label="Quick access to the record values"><!---->Quick access to the record values<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/18-changes-in-the-structure.html" class="nav-link sidebar-link sidebar-page" aria-label="Changes in the structure of the internal array of MemTableEh without losing data"><!---->Changes in the structure of the internal array of MemTableEh without losing data<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/19-save-load-data-from-to-file.html" class="nav-link sidebar-link sidebar-page" aria-label="Save/load data from/to the file (s)"><!---->Save/load data from/to the file (s)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/20-internal-objects-of-tmemtableeh.html" class="nav-link sidebar-link sidebar-page" aria-label="Internal objects of TMemTableEh component"><!---->Internal objects of TMemTableEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/21-storing-records-in-tree-mode-tree-view.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Storing records in tree mode (TreeView)"><!---->Storing records in tree mode (TreeView)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/22-workig-with-tmemtableeh-at-designtime.html" class="nav-link sidebar-link sidebar-page" aria-label="Workig with TMemTableEh at design-time"><!---->Workig with TMemTableEh at design-time<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/28-tdatadrivereh-component.html" class="nav-link sidebar-link sidebar-page" aria-label="TDataDriverEh component"><!---->TDataDriverEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDataDriverEh component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Components for consolidated data analysis</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Components for planning and event management</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Ð¡reating Xlsx files (TXlsMemFileEh class)</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/33-components-for-uploading-data-set-text.html" class="nav-link sidebar-link sidebar-page" aria-label="Components for uploading DataSet to a text file and load a text file"><!---->Components for uploading DataSet to a text file and load a text file<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/34-hiding-a-component-form-in-design-time.html" class="nav-link sidebar-link sidebar-page" aria-label="Hiding a component form in Design-Time"><!---->Hiding a component form in Design-Time<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/35-feedbacks-and-bug-reports.html" class="nav-link sidebar-link sidebar-page" aria-label="Feedbacks and bug reports"><!---->Feedbacks and bug reports<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Storing records in tree mode (TreeView)</h1><div class="page-info"><span class="author-info" aria-label="AuthorðŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://www.ehlib.com" target="_blank" rel="noopener noreferrer">Admin</a></span><span property="author" content="Admin"></span></span><!----><!----><!----><!----><span class="reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 6 min</span><meta property="timeRequired" content="PT6M"></span></div><hr></div><!----><!----><div class="theme-hope-content"><h1 id="storing-records-in-tree-mode-treeview" tabindex="-1"><a class="header-anchor" href="#storing-records-in-tree-mode-treeview" aria-hidden="true">#</a> Storing records in tree mode (TreeView)</h1><p>In tree mode the <code>TMemTableEh create node objects (</code>TMemRecViewEh type<code>) for each record in the internal array. Node object have reference to parent record (</code>Rec property<code>) and has a list of child nodes (</code>NodeItems`).</p><p>Adjusting <code>TreeView</code> mode is realized by subproperties of <code>TMemTableEh.TreeList</code> property. <code>TMemTableEh</code> automatically adds new record in the tree, using field values defined by <code>TreeList.KeyFieldName</code> and <code>TreeList.RefParentFieldName</code> properties. When new record is appearances in <code>MemTable</code>, it tries to find <code>Parent</code> record in the list of existing records, it looks throw records trying to find values of the field in <code>KeyFieldName</code> that is equal to the value of the field defined by <code>RefParentFieldName</code> property in the new record. Furthermore, it checks, if this record is a parent for other existing records in array.</p><p>Building of tree can be speeding up, if you create indexes for fields specified in <code>TreeList.KeyFieldName</code> and <code>TreeList.RefParentFieldName</code> properties.</p><p>However the maximum speed of building tree is possible to achieve if the records all records will be appended in <code>DataSet</code> in valid sequence.</p><p>In other words every record must be added in <code>DataSet</code> in same order as it appears in the tree. In last case it is not recommended to create indexes, it can only slow down building of tree. If records appear in <code>DataSet</code> in valid order set <code>FullBuildCheck</code> to False. It will not check if the new record have child records in DataSet.</p><p>Use the next events to control the tree node expanding in <code>TMemTableEh</code> components.</p><p>In the <code>TMemTableEh</code> class in the published section new events added. Events fire before or after the expanding of a tree node.</p><p><code>property OnRecordsViewTreeNodeExpanding;</code></p><p><code>property OnRecordsViewTreeNodeExpanded;</code></p><p>Events fire when MemTableEh is in tree mode (MemTableEh.TreeList.Active = True).</p><p><code>OnRecordsViewTreeNodeExpanding</code> event is useful for dynamic loading of the elements of the tree before node opens.</p><p>For an example of using <code>OnRecordsViewTreeNodeExpanding</code> event see the next demo project: <code>DEMOS\DBGridEh.DirTree</code></p><p>The following classes and properties are used to access and control the operation of <code>MemTableEh</code> in tree mode:</p><p><code>TMemTableTreeListEh</code></p><dd><p>The <code>TMemTableEh.TreeList</code> property is of the TMemTableTreeListEh type and is intended for setting the tree formation at design-time. This property does not contain tree nodes and is intended only for customization.</p></dd><p><code>TMemRecViewEh</code></p><dd><p>Tree nodes are of type <code>TMemRecViewEh</code> and are stored in class <code>TMemoryTreeListEh</code> (property <code>TMemTableEh.RecordsView.MemoryTreeList</code>) in the form of a tree structure. <code>TMemRecViewEh</code> objects are also used in the flat non-tree <code>TMemTableEh</code> mode. In the flat mode, the properties related to the tree in the object of the <code>TMemRecViewEh</code> class are not used. The main class property is a reference to the primary <code>Rec</code> records of the <code>TMemoryRecordEh</code> type and properties for controlling the branch of the <code>NodeIndex</code>, <code>NodeItems</code>, <code>NodesCount</code>, <code>NodeLevel</code>, <code>NodeParent</code>, etc.</p></dd><p>The following properties can be used to access tree nodes:</p><p><code>property TMemTableEh.RecordsView.MemoryTreeList.Root: TMemRecViewEh</code></p><dd>The root node of the tree. This node is not displayed in the tree. Link to the primary record Rec = nil. This node is always present in the tree even when the DataSet contains no entries.</dd><p><code>property TMemTableEh.RecView: TMemRecViewEh;</code></p><dd>A reference to the tree node object on which an entry is currently set in the DataSet. Available only in tree mode.</dd><p><code>TMemoryTreeListEh</code></p><dd>Directly the class in which the node tree (tree nodes) is stored. You do not need to form a tree based on the entries in the TMemTableEh.RecordsView.MemTableData.RecordsList list. TMemTableEh does this automatically when new records appear in the original RecordsList. </dd><p>To access the status of the tree node of the current Datasetâ€™s record, you can use the following TMemTableEh properties:</p><p><code>property RecView: TMemRecViewEh;</code></p><dd>A reference to the tree node of the tree, it is available only in tree mode.</dd><p><code>property TreeNode: TMemRecViewEh;</code></p><dd>A link to the View data record object.</dd><p><code>property TMemTableEh.TreeNodeLevel: Integer;</code></p><dd>Indicates the level of the node in the tree.</dd><p><code>property TMemTableEh.TreeNodeExpanded: Boolean</code></p><dd>Specifies whether the tree node is expanded.</dd><p><code>property TMemTableEh.TreeNodeHasChildren: Boolean</code></p><dd>Indicates whether a node has any children.</dd><p><code>property TMemTableEh.TreeNodeChildCount: Integer</code></p><dd>An amount of Child elements.</dd><br><p>Properties of the <code>TMemTableTreeListEh</code> class (<code>TMemTableEh.TreeList</code> property):</p><p><code>property Active: Boolean</code></p><dd><p>Defines that <code>TreeView</code> mode is active. In <code>TreeView</code> mode you can access <code>TMemTableEh</code> properties: <code>TreeNodeLevel</code>, <code>TreeNodeExpanded</code>, <code>TreeNodeHasChildren</code>, <code>TreeNodeChildCount</code> for current record.</p></dd><p><code>property KeyFieldName: String</code></p><dd>Holds a name of the key field of record. Child record will refer to parental record with the key determined by the KeyFieldName field.</dd><p><code>property RefParentFieldName: String;</code></p><dd>Holds a name of the field that contain reference value to a parent record.</dd><p><code>property DefaultNodeExpanded: Boolean;</code></p><dd>Defines a value of Expanded property for new elements of the tree.</dd><p><code>property DefaultNodeHasChildren: Boolean;</code></p><dd>Defines a value of HasChildren property for a new elements of the tree.</dd><p><code>property FullBuildCheck: Boolean</code></p><dd>Defines if need check if there are Child records in array for new record. Setting this property to False can speed up building of tree, but all child records must be added after parent record.</dd><br><p>Methods of the TMemTableTreeListEh class (<code>TMemTableEh.TreeList</code> property):</p><p><code>function Locate(const KeyFields: string; const KeyValues: Variant; Options: TLocateOptions): Boolean; virtual;</code></p><dd> The method finds an entry in the source list of TMemTableEh.RecordsView.MemTableData.RecordsList and positions the current position in the tree to the node that points to the found entry. If the found node or top-level node is closed (Expanded = False), then the node is expanded so that the record becomes visible in the grid and in the list of visible expanded records. In this case, the record can still not be found if it is hidden through the filter DataSet.Filter or DataSet.OnFilterRecord. </dd><p><code>procedure FullCollapse; virtual;</code> Collapse all the branches of the tree.</p><p><code>procedure FullExpand; virtual;</code> Expand all the branches of the tree. <br></p><p>Properties of the class <code>TMemRecViewEh</code>:</p><p><code>property NodeExpanded: Boolean</code> Node tree disclosed</p><p><code>property NodeHasChildren: Boolean</code> Node has a Child nodes</p><p><code>property NodeHasVisibleChildren: Boolean</code> The node has visible nodes Child</p><p><code>property NodeIndex: Integer</code> Index node in the node list Parent</p><p><code>property NodeItems[const Index: Integer]: TMemRecViewEh</code> Access to Child nodes</p><p><code>property NodeLevel: Integer</code> Level node in the tree</p><p><code>property NodeOwner: TMemoryTreeListEh</code> Tree nodes owner.</p><p><code>property NodeParent: TMemRecViewEh</code> Parent node for this node.</p><p><code>property NodesCount: Integer</code> Number of Child nodes</p><p><code>property NodeVisible: Boolean</code> Property Value Visible. The node can be visible or not visible in the tree. MemTableEh automatically sets the status of the node, depending on the status of the filtering entries. For all the records that do not fall into the filter assembly NodeVisible property is set to False.</p><p><code>property VisibleNodeIndex: Integer</code> The index of the node in the list of visible nodes Parent node</p><p><code>property VisibleNodeItems[const Index: Integer]: TMemRecViewEh</code> Access to visible Child nodes</p><p><code>property VisibleNodesCount: Integer</code> The number of visible nodes Child <br></p><p>Traversing the tree, depending on the state of the nodes and the contents of the original record.</p><p>Traversing a tree using DataSetâ€™s methods.</p><p>Using the classic DataSetâ€™s Eof property and the Next method, you can bypass the tree, taking into account the filtered open tree nodes.</p><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">procedure</span> TForm1<span class="token punctuation">.</span>Button4Click<span class="token punctuation">(</span>Sender<span class="token punctuation">:</span> TObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span>
  NameField<span class="token punctuation">:</span> TField<span class="token punctuation">;</span>
  s<span class="token punctuation">:</span> <span class="token keyword">String</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>
  NameField <span class="token operator">:=</span> MemTableEh1<span class="token punctuation">.</span>FieldByName<span class="token punctuation">(</span><span class="token string">&#39;Name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  MemTableEh1<span class="token punctuation">.</span>DisableControls<span class="token punctuation">;</span>
  MemTableEh1<span class="token punctuation">.</span>First<span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token operator">not</span> MemTableEh1<span class="token punctuation">.</span>Eof <span class="token keyword">do</span>
  <span class="token keyword">begin</span>
    s <span class="token operator">:=</span> StringOfChar<span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> MemTableEh1<span class="token punctuation">.</span>TreeNode<span class="token punctuation">.</span>NodeLevel<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> NameField<span class="token punctuation">.</span>AsString<span class="token punctuation">;</span>
    DBMemoEh1<span class="token punctuation">.</span>Lines<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    MemTableEh1<span class="token punctuation">.</span>Next<span class="token punctuation">;</span>
  <span class="token keyword">end</span><span class="token punctuation">;</span>
  MemTableEh1<span class="token punctuation">.</span>EnableControls<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div><p>With this method of traversing, only Expanded Visible tree nodes will be listed. The visibility of tree nodes is set by filtering data in the DataSet through the DataSet.Filter property.</p><p>Traversing a tree using a recursive function. Having obtained a link to the root node of the tree, using the properties of access to the list of child nodes and the recursive function, you can bypass the entire data tree.</p><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">procedure</span> TForm1<span class="token punctuation">.</span>Button4Click<span class="token punctuation">(</span>Sender<span class="token punctuation">:</span> TObject<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">procedure</span> WriteTreeNode<span class="token punctuation">(</span>Node<span class="token punctuation">:</span> TMemRecViewEh<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span>
    i<span class="token punctuation">:</span> Integer<span class="token punctuation">;</span>
    CurSubNode<span class="token punctuation">:</span> TMemRecViewEh<span class="token punctuation">;</span>
  <span class="token keyword">begin</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span> <span class="token keyword">to</span> Node<span class="token punctuation">.</span>NodesCount<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">do</span>
    <span class="token keyword">begin</span>
      CurSubNode <span class="token operator">:=</span> Node<span class="token punctuation">.</span>NodeItems<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      DBMemoEh1<span class="token punctuation">.</span>Lines<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>
        StringOfChar<span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> CurSubNode<span class="token punctuation">.</span>NodeLevel<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span>
        VarToStr<span class="token punctuation">(</span>CurSubNode<span class="token punctuation">.</span>Rec<span class="token punctuation">.</span>DataValues<span class="token punctuation">[</span><span class="token string">&#39;NAME&#39;</span><span class="token punctuation">,</span> dvvValueEh<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; - &#39;</span> <span class="token operator">+</span>
        VarToStr<span class="token punctuation">(</span>CurSubNode<span class="token punctuation">.</span>Rec<span class="token punctuation">.</span>DataValues<span class="token punctuation">[</span><span class="token string">&#39;ID&#39;</span><span class="token punctuation">,</span> dvvValueEh<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      WriteTreeNode<span class="token punctuation">(</span>CurSubNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span><span class="token punctuation">;</span>
  <span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token keyword">begin</span>
  WriteTreeNode<span class="token punctuation">(</span>
    MemTableEh1<span class="token punctuation">.</span>RecordsView<span class="token punctuation">.</span>MemoryTreeList<span class="token punctuation">.</span>Root
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div><p>At the same time at each step you can check the visibility of the node (<code>CurSubNode.Visible</code>).</p><p>You can also check the <code>CurSubNode.Expanded</code> property to check if the node is open to get a list of only the expanded nodes. You can also check the field values of the original record to get a list of nodes depending on the values of the <code>MemTableEh</code> record. To access the value of the fields, use the <code>Rec</code> property of the current node - <code>CurSubNode.Rec.DataValues[&#39;FieldName&#39;, dvvValueEh]</code>.</p><p>Traversing the tree using the <code>TMemoryTreeListEh</code> class internal flat lists. The <code>TMemoryTreeListEh</code> class contains a set of ready-made list of pointers to <code>TMemRecViewEh</code>, which can be used to traverse the tree depending on the conditions of the filtered / unfiltered records and the expanded (un-opened) nodes</p><p>To access these lists, use the following lists. Full list of nodes, regardless of filtering and openness status</p><p><code>property FlatListCount: Integer</code> Number of entries in the list</p><p><code>property FlatListItem[const Index: Integer]: TMemRecViewEh</code> Access to list items as an array</p><p>The list of nodes with the filter applied in the DataSet</p><p><code>property AccountableCount: Integer</code><code>property AccountableItem[const Index: Integer]: TMemRecViewEh</code></p><p>List of nodes based on filter and openness status <code>property VisibleExpandedCount: Integer</code><code>property VisibleExpandedItem [const Index: Integer]: TMemRecViewEh</code></p><p>In this example, a complete list of tree nodes is displayed, regardless of the openness status.</p><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">procedure</span> TForm1<span class="token punctuation">.</span>Button5Click<span class="token punctuation">(</span>Sender<span class="token punctuation">:</span> TObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span>
  i<span class="token punctuation">:</span> Integer<span class="token punctuation">;</span>
  Node<span class="token punctuation">:</span> TMemRecViewEh<span class="token punctuation">;</span>
<span class="token keyword">begin</span>
  <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span> <span class="token keyword">to</span> MemTableEh1<span class="token punctuation">.</span>RecordsView<span class="token punctuation">.</span>MemoryTreeList<span class="token punctuation">.</span>FlatListCount<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">do</span>
  <span class="token keyword">begin</span>
    Node <span class="token operator">:=</span> MemTableEh1<span class="token punctuation">.</span>RecordsView<span class="token punctuation">.</span>MemoryTreeList<span class="token punctuation">.</span>FlatListItem<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    DBMemoEh1<span class="token punctuation">.</span>Lines<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>
        StringOfChar<span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> Node<span class="token punctuation">.</span>NodeLevel<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span>
        VarToStr<span class="token punctuation">(</span>Node<span class="token punctuation">.</span>Rec<span class="token punctuation">.</span>DataValues<span class="token punctuation">[</span><span class="token string">&#39;NAME&#39;</span><span class="token punctuation">,</span> dvvValueEh<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; - &#39;</span> <span class="token operator">+</span>
        VarToStr<span class="token punctuation">(</span>Node<span class="token punctuation">.</span>Rec<span class="token punctuation">.</span>DataValues<span class="token punctuation">[</span><span class="token string">&#39;ID&#39;</span><span class="token punctuation">,</span> dvvValueEh<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div><p>Walk through the tree from the current node of the branch up through the tree to the root node.</p><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">procedure</span> TForm1<span class="token punctuation">.</span>Button5Click<span class="token punctuation">(</span>Sender<span class="token punctuation">:</span> TObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span>
  RecView<span class="token punctuation">:</span> TMemRecViewEh<span class="token punctuation">;</span>
<span class="token keyword">begin</span>
  RecView <span class="token operator">:=</span> MemTableEh1<span class="token punctuation">.</span>RecView<span class="token punctuation">;</span>
  <span class="token keyword">while</span> RecView <span class="token operator">&lt;&gt;</span> MemTableEh1<span class="token punctuation">.</span>RecordsView<span class="token punctuation">.</span>MemoryTreeList<span class="token punctuation">.</span>Root <span class="token keyword">do</span>
  <span class="token keyword">begin</span>
    DBMemoEh1<span class="token punctuation">.</span>Lines<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>
      StringOfChar<span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> RecView<span class="token punctuation">.</span>NodeLevel<span class="token punctuation">)</span> <span class="token operator">+</span>
      VarToStr<span class="token punctuation">(</span>RecView<span class="token punctuation">.</span>Rec<span class="token punctuation">.</span>DataValues<span class="token punctuation">[</span><span class="token string">&#39;NAME&#39;</span><span class="token punctuation">,</span> dvvValueEh<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    RecView <span class="token operator">:=</span> RecView<span class="token punctuation">.</span>NodeParent<span class="token punctuation">;</span>
  <span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div></div><!----><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/20-internal-objects-of-tmemtableeh.html" class="nav-link prev" aria-label="Internal objects of TMemTableEh component"><div class="hint"><span class="arrow left"></span>Prev</div><div class="link"><!---->Internal objects of TMemTableEh component</div></a><a href="/online-help-vuepress-hope/EhLibDoc/27-tmemtableeh-component/22-workig-with-tmemtableeh-at-designtime.html" class="nav-link next" aria-label="Workig with TMemTableEh at design-time"><div class="hint">Next<span class="arrow right"></span></div><div class="link">Workig with TMemTableEh at design-time<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/online-help-vuepress-hope/assets/app.ac77cf73.js" defer></script>
  </body>
</html>
