<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.53" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/online-help-vuepress-hope/EhLibDoc/05-language-resources.html"><meta property="og:site_name" content="EhLib.VCL Developerâ€™s guide"><meta property="og:title" content="Language resources"><meta property="og:description" content="Delphi standard recommends use resourcestring and individual versions of dfm files for strings that are language-dependent constant. EhLib since version 9 uses a slightly differ..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><link rel="icon" href="/online-help-vuepress-hope/favicon.ico"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/online-help-vuepress-hope/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/online-help-vuepress-hope/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/online-help-vuepress-hope/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>Language resources | EhLib.VCL Developerâ€™s guide</title><meta name="description" content="Delphi standard recommends use resourcestring and individual versions of dfm files for strings that are language-dependent constant. EhLib since version 9 uses a slightly differ...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/online-help-vuepress-hope/assets/style.c7186ee6.css" as="style" /><link rel="stylesheet" href="/online-help-vuepress-hope/assets/style.c7186ee6.css" />
    <link rel="modulepreload" href="/online-help-vuepress-hope/assets/app.ac77cf73.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/05-language-resources.html.4a82afac.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/05-language-resources.html.7f1dd6a3.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/online-help-vuepress-hope/" class="brand"><img class="logo" src="/online-help-vuepress-hope/EhLib.Logo.Text.png" alt="EhLib.VCL Developerâ€™s guide"><!----><span class="site-name hide-in-pad">EhLib.VCL Developerâ€™s guide</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!----><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><!----><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><div class="search-pro-button" role="search" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg></div><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading clickable active"><!----><a href="/online-help-vuepress-hope/EhLibDoc/" class="title"></a><!----></p><ul class="sidebar-links"><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/00-content.html" class="nav-link sidebar-link sidebar-page" aria-label="Content"><!---->Content<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/01-introduction.html" class="nav-link sidebar-link sidebar-page" aria-label="Introduction"><!---->Introduction<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/02-specifications.html" class="nav-link sidebar-link sidebar-page" aria-label="Specification"><!---->Specification<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/03-installing.html" class="nav-link sidebar-link sidebar-page" aria-label="Installing"><!---->Installing<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/04-list-of-components-and-classes.html" class="nav-link sidebar-link sidebar-page" aria-label="List of components and classes"><!---->List of components and classes<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Language resources"><!---->Language resources<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html#working-with-language-resources-through-external-files" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Working with language resources through external files"><!---->Working with language resources through external files<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html#create-language-resources-for-the-language-constants-of-your-application" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Create language resources for the language constants of your application"><!---->Create language resources for the language constants of your application<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html#default-language-resource" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Default language resource"><!---->Default language resource<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html#demo-projects-using-dynamic-language-resources-loading" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Demo projects using dynamic language resources loading"><!---->Demo projects using dynamic language resources loading<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDBGridEh Component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TPrintDBGridEh component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDBVertGridEh component</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/13-using-tdbsumlist-component.html" class="nav-link sidebar-link sidebar-page" aria-label="Using TDBSumList component"><!---->Using TDBSumList component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Edit controls</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html" class="nav-link sidebar-link sidebar-page" aria-label="DropDownForms - custom drop-down windows"><!---->DropDownForms - custom drop-down windows<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/21-printing-components-of-library.html" class="nav-link sidebar-link sidebar-page" aria-label="Printing components of Library"><!---->Printing components of Library<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/22-export-library-components-to-pdf-file.html" class="nav-link sidebar-link sidebar-page" aria-label="Export library components to Pdf file"><!---->Export library components to Pdf file<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/23-generating-pdf-files-using-the-printer-class.html" class="nav-link sidebar-link sidebar-page" aria-label="Generating Pdf Files Using the Printer Class"><!---->Generating Pdf Files Using the Printer Class<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/24-view-properties-of-components-at-run-time.html" class="nav-link sidebar-link sidebar-page" aria-label="View properties of components at Run-Time"><!---->View properties of components at Run-Time<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/25-using-tpropstorageeh-components.html" class="nav-link sidebar-link sidebar-page" aria-label="TPropStorageEh component"><!---->TPropStorageEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/26-mem-table-and-data-driver.html" class="nav-link sidebar-link sidebar-page" aria-label="MemTable and DataDriver"><!---->MemTable and DataDriver<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TMemTableEh component</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/28-tdatadrivereh-component.html" class="nav-link sidebar-link sidebar-page" aria-label="TDataDriverEh component"><!---->TDataDriverEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDataDriverEh component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Components for consolidated data analysis</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Components for planning and event management</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Ð¡reating Xlsx files (TXlsMemFileEh class)</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/33-components-for-uploading-data-set-text.html" class="nav-link sidebar-link sidebar-page" aria-label="Components for uploading DataSet to a text file and load a text file"><!---->Components for uploading DataSet to a text file and load a text file<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/34-hiding-a-component-form-in-design-time.html" class="nav-link sidebar-link sidebar-page" aria-label="Hiding a component form in Design-Time"><!---->Hiding a component form in Design-Time<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/35-feedbacks-and-bug-reports.html" class="nav-link sidebar-link sidebar-page" aria-label="Feedbacks and bug reports"><!---->Feedbacks and bug reports<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Language resources</h1><div class="page-info"><span class="author-info" aria-label="AuthorðŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://www.ehlib.com" target="_blank" rel="noopener noreferrer">Admin</a></span><span property="author" content="Admin"></span></span><!----><!----><!----><!----><span class="reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 4 min</span><meta property="timeRequired" content="PT4M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">On This Page</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html#working-with-language-resources-through-external-files" class="router-link-active router-link-exact-active toc-link level3">Working with language resources through external files</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html#create-language-resources-for-the-language-constants-of-your-application" class="router-link-active router-link-exact-active toc-link level3">Create language resources for the language constants of your application</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html#default-language-resource" class="router-link-active router-link-exact-active toc-link level3">Default language resource</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html#demo-projects-using-dynamic-language-resources-loading" class="router-link-active router-link-exact-active toc-link level3">Demo projects using dynamic language resources loading</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="language-resources" tabindex="-1"><a class="header-anchor" href="#language-resources" aria-hidden="true">#</a> Language resources</h1><p><code>Delphi</code> standard recommends use resourcestring and individual versions of dfm files for strings that are language-dependent constant.</p><p>EhLib since version 9 uses a slightly different technology for storing language resources.</p><ol><li>Constants of resourcestring type are not used.</li><li>All string resources are stored in one file - <code>EhLibLangConsts.dfm</code> and <code>EhLibLangConsts.XXX.dfm</code> files for each language.</li><li>Language strings are stored as properties of <code>TEhLibLanguageConsts</code> class.</li></ol><p>This technology has the following advantages:</p><ol><li>Language resources can be downloaded at any time while the program is running.</li><li>The language can be set as an end user and selected automatically.</li><li>Language resources can be stored as separate files, so embed in an exe file.</li></ol><p>![](../images/Language resources.png)</p><p>All string library constants that depend on the language are stored in the properties of the class <code>TEhLibLanguageConsts</code> (source files <code>EhLibLangConsts.dfm</code> + <code>EhLibLangConsts.pas</code>)</p><p>To access a class object, use the global function <code>EhLibLanguageConsts: TEhLibLanguageConsts</code>. Versions of strings in other languages are stored in similar files with the corresponding name</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>EhLibLangConsts.ENU.dfm
EhLibLangConsts.FRA.dfm
EhLibLangConsts.RUS.dfm
EhLibLangConsts.UKR.dfm
...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>in folder <code>&lt;EhLib archive &gt;\LangResources\Res\</code> When installing the library in the IDE, the files in this folder should be copied to the folder <code>&lt;EhLib installed dir&gt;\Lib\</code> If the file for your language is not in the folder, you can create it. To do this, copy the file <code>EhLibLangConsts.ENU.dfm</code> to a new file <code>EhLibLangConsts.XXX.dfm</code> where <code>XXX</code> is the three-letter language code. Using a text editor, change the text in the <code>dfm</code> file to the desired text. The three-letter language code can be found in the table at the following address: <a href="https://www.microsoft.com/resources/msdn/goglobal/default.mspx" target="_blank" rel="noopener noreferrer">https://www.microsoft.com/resources/msdn/goglobal/default.mspx<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> Inside the file, also change the class name from <code>TEhLibLanguageConsts_ENU</code> to the new name <code>TEhLibLanguageConsts_XXX</code> (where XXX is the three-letter language code).</p><p>While the program is running while changing the language, the algorithm finds the desired language file by three-letter code and loads into the EhLibLanguageConsts object as an external dfm resource or for embedded resources by the last three characters in the name of the resource <code>TEhLibLanguageConsts_XXX</code>. Inside the program, the following code is used to change the language</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code>  LanguageResourceManagerEh<span class="token punctuation">.</span>ActiveLanguageAbbr <span class="token operator">:=</span> <span class="token string">&#39;THREE-LETTER CODE&#39;</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To select the language automatically, use the following code</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code>LanguageResourceManagerEh<span class="token punctuation">.</span>ActiveLanguageAbbr <span class="token operator">:=</span> LanguageResourceManagerEh<span class="token punctuation">.</span>AutoselectLanguage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The language is chosen based on the variable - <code>System.SysUtils.SysLocale.DefaultLCID</code> If the appropriate files or the built-in resource for the selected language was not found, the default language is downloaded from the built-in resource described in the <code>EhLibLangConsts.dfm</code> file. The EhLibLangConsts.dfm file links into the EXE file at compile time.</p><h3 id="working-with-language-resources-through-external-files" tabindex="-1"><a class="header-anchor" href="#working-with-language-resources-through-external-files" aria-hidden="true">#</a> Working with language resources through external files</h3><p>When loading resources from a file, the algorithm looks for a file with a name: <code>&lt;EXE File Placment&gt;\Res\EhLibLangConsts.[XXX].dfm</code></p><p>Where <code>XXX</code> is a three-character language code. You can configure the resource download folder by assigning a global variable <code>LanguageResourcesEh.LanguageResourcesFolder: String</code></p><p>To use additional resources in your application, you must supply the <code>EhLibLangConsts.XXX.dfm</code> files along with the <code>EXE</code> file.</p><p>The files in the Res folder are stored in the Utf8 encoding. For the work of this technology in <code>Delphi7-Delphi2005</code> for these versions of Delphi, similar files are stored in the Res.Ansi folder in the Ansi encoding.</p><p>In the code of the program you can download a list of available resources for downloading the language using the code</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code>LanguageResourceManagerEh<span class="token punctuation">.</span>LoadListOfAvailableLanguages<span class="token punctuation">(</span><span class="token string">&#39;EhLibLangConsts&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The algorithm will scan the <code>\Res</code> folder for <code>EhLibLangConsts.[XXX].dfm</code> files and fill in the internal property of <code>EhLibLanguageConsts.LanguageList</code>. To access the list of available languages, use the property <code>LanguageResourceManagerEh.LanguageList</code></p><h3 id="create-language-resources-for-the-language-constants-of-your-application" tabindex="-1"><a class="header-anchor" href="#create-language-resources-for-the-language-constants-of-your-application" aria-hidden="true">#</a> Create language resources for the language constants of your application</h3><p>You can also use the technology of storing language dependent constants to store the strings of your application. For this</p><ol><li>Create a class that inherits from TComponent and write in it in the published section whose properties the values in your application depend on the language. (For an example, see the <code>AppLangConsts.pas</code> file from the Demo application <code>DEMOS\MainDemo\</code> )</li></ol><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code>  TApplicationLanguageConsts <span class="token operator">=</span> <span class="token keyword">class</span><span class="token punctuation">(</span>TComponent<span class="token punctuation">)</span>
  <span class="token operator">..</span>
  <span class="token keyword">public</span>
    <span class="token keyword">constructor</span> Create<span class="token punctuation">(</span>AOwner<span class="token punctuation">:</span> TComponent<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">override</span><span class="token punctuation">;</span>
  <span class="token keyword">published</span>
    <span class="token keyword">property</span> Caption<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token keyword">read</span> FCaption <span class="token keyword">write</span> SetCaption<span class="token punctuation">;</span>
    <span class="token keyword">property</span> MenuFile<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token keyword">read</span> FMenuFile <span class="token keyword">write</span> FMenuFile<span class="token punctuation">;</span>
  <span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the class constructor, load the values of the constants that will be used by default using next code:</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code>  <span class="token keyword">constructor</span> TApplicationLanguageConsts<span class="token punctuation">.</span>Create<span class="token punctuation">(</span>AOwner<span class="token punctuation">:</span> TComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">begin</span>
    <span class="token keyword">inherited</span> Create<span class="token punctuation">(</span>AOwner<span class="token punctuation">)</span><span class="token punctuation">;</span>
    InitInheritedComponent<span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">,</span> TCustomControl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Create a resource dfm file (AppLangConsts.dfm) to store the property values of the class</li></ol><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code>  <span class="token keyword">object</span> TApplicationLanguageConsts
    Caption <span class="token operator">=</span> <span class="token string">&#39;EhLib Main Complex Demo&#39;</span>
    MenuFile <span class="token operator">=</span> <span class="token string">&#39;File&#39;</span>
  <span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>write the dfm file as the resource of your application</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code>  <span class="token directive marco property">{$R AppLangConsts.dfm}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li></li></ol><p>Create files</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>  AppLangConsts.ENU.dfm
  AppLangConsts.BGR.dfm
  AppLangConsts.CHS.dfm
  AppLangConsts.CSY.dfm
  AppLangConsts.DEU.dfm
...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>By analogy with the files EhLibLangConsts.XXX.dfm</p><ol start="4"><li>Once in the program code, create a variable for storing resources</li></ol><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code>  FApplicationLanguageConsts <span class="token operator">:=</span> TApplicationLanguageConsts<span class="token punctuation">.</span>Create<span class="token punctuation">(</span><span class="token keyword">nil</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="5"><li>Once in the program code, register the resource in LanguageResourceManager</li></ol><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code>  LanguageResourceManagerEh<span class="token punctuation">.</span>AddLocalizableObject<span class="token punctuation">(</span>FApplicationLanguageConsts<span class="token punctuation">,</span>
       FApplicationLanguageConsts<span class="token punctuation">.</span>ClassName<span class="token punctuation">,</span> <span class="token string">&#39;AppLangConsts&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ENU&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>When changing the language, the <code>WM_SETTINGCHANGE</code> event is sent to all forms and controls.</p><h3 id="default-language-resource" tabindex="-1"><a class="header-anchor" href="#default-language-resource" aria-hidden="true">#</a> Default language resource</h3><p>There is a concept - the built-in library language by default. If you do not perform any actions to change the language in the application, then the default language resource in the library is used. To change the default built-in language for all programs used:</p><ol><li>Copy the <code>LangResources\Res\EhLibLangConsts.XXX.dfm</code> file to the installed library folder in the <code>Lib\EhLibLangConsts.dfm</code> file.</li><li>Delete the first line of the file with the suffix <code>_XXX</code> in the name of the class so it will look like the following: <code>object TEhLibLanguageConsts</code></li><li>Recompile the library packages. When the library is installed with <code>EhLibInstaller.exe</code>, the program performs this action automatically.</li></ol><h3 id="demo-projects-using-dynamic-language-resources-loading" tabindex="-1"><a class="header-anchor" href="#demo-projects-using-dynamic-language-resources-loading" aria-hidden="true">#</a> Demo projects using dynamic language resources loading</h3><p>For an example of using built-in and external resources, see the Demo project</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>DEMOS\LanguageResEmbeddedExternal\Project1.dpr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>In the <code>Unit1.pas</code> file, you can comment out or uncomment the lines</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code><span class="token directive marco property">{$DEFINE EMBEDDED_LANGUAGE_RESOURCES}</span> 
<span class="token directive marco property">{$DEFINE EMBEDDED_LANGUAGE_RESOURCES_ALL}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>To change the mode of using resources and understand the difference in working with built-in and external resources. For detailed information on how to use the specified DEFINE definitions to change the resource usage mode, see the file</p><p><code>Demos\LanguageResEmbeddedExternal\Info.Txt</code></p><p>Another example of the use of dynamic loading of language resources can be seen in the Demo project</p><p><code>DEMOS\MainDemo\Project1.dpr</code></p><p>The main methods used in the project for working with language resources are as follows:</p><p><code>procedure AppLangConsts.InitUnit;</code></p><dd>Registers the class TApplicationLanguageConsts in which the application&#39;s string resources will be stored.</dd><br><p><code>procedure TForm1.InitLanguageRes;</code></p><dd>Loads the list of available languages.<br> Activates the language from the Ini file if it was selected the last time the program was started.</dd><br><p><code>procedure TForm1.BuildLanguageMenu;</code></p><dd>Forms a menu of available languages based on the LanguageResourceManagerEh.LanguageList object</dd><br><p><code>procedure TForm1.MenuItemSelectLanguage(Sender: TObject);</code></p><dd>Loads files of a new language when the user selects another language in the menu.</dd><br><p><code>procedure TForm1.ResourceLanguageChanged;</code></p><dd>Assigns properties and form variables when the language has been changed.</dd><br></div><!----><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><a href="/online-help-vuepress-hope/EhLibDoc/04-list-of-components-and-classes.html" class="nav-link prev" aria-label="List of components and classes"><div class="hint"><span class="arrow left"></span>Prev</div><div class="link"><!---->List of components and classes</div></a><!----></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/online-help-vuepress-hope/assets/app.ac77cf73.js" defer></script>
  </body>
</html>
