<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.53" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html"><meta property="og:site_name" content="EhLib.VCL Developerâ€™s guide"><meta property="og:title" content="DropDownForms - custom drop-down windows"><meta property="og:description" content="Typical DropDown window - is a list that appears in the control TComboBox when you click on the edit button. New technology allows you to create a customizable drop-down windows..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><link rel="icon" href="/online-help-vuepress-hope/favicon.ico"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/online-help-vuepress-hope/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/online-help-vuepress-hope/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/online-help-vuepress-hope/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>DropDownForms - custom drop-down windows | EhLib.VCL Developerâ€™s guide</title><meta name="description" content="Typical DropDown window - is a list that appears in the control TComboBox when you click on the edit button. New technology allows you to create a customizable drop-down windows...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/online-help-vuepress-hope/assets/style.c7186ee6.css" as="style" /><link rel="stylesheet" href="/online-help-vuepress-hope/assets/style.c7186ee6.css" />
    <link rel="modulepreload" href="/online-help-vuepress-hope/assets/app.ac77cf73.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/20-drop-down-forms.html.5b1d2f85.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/20-drop-down-forms.html.6b83c379.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/online-help-vuepress-hope/" class="brand"><img class="logo" src="/online-help-vuepress-hope/EhLib.Logo.Text.png" alt="EhLib.VCL Developerâ€™s guide"><!----><span class="site-name hide-in-pad">EhLib.VCL Developerâ€™s guide</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!----><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><!----><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><div class="search-pro-button" role="search" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg></div><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading clickable active"><!----><a href="/online-help-vuepress-hope/EhLibDoc/" class="title"></a><!----></p><ul class="sidebar-links"><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/00-content.html" class="nav-link sidebar-link sidebar-page" aria-label="Content"><!---->Content<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/01-introduction.html" class="nav-link sidebar-link sidebar-page" aria-label="Introduction"><!---->Introduction<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/02-specifications.html" class="nav-link sidebar-link sidebar-page" aria-label="Specification"><!---->Specification<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/03-installing.html" class="nav-link sidebar-link sidebar-page" aria-label="Installing"><!---->Installing<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/04-list-of-components-and-classes.html" class="nav-link sidebar-link sidebar-page" aria-label="List of components and classes"><!---->List of components and classes<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html" class="nav-link sidebar-link sidebar-page" aria-label="Language resources"><!---->Language resources<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDBGridEh Component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TPrintDBGridEh component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDBVertGridEh component</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/13-using-tdbsumlist-component.html" class="nav-link sidebar-link sidebar-page" aria-label="Using TDBSumList component"><!---->Using TDBSumList component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Edit controls</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="DropDownForms - custom drop-down windows"><!---->DropDownForms - custom drop-down windows<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#step-1-creating-a-doprdown-form-class" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Step 1 - Creating a DoprDown Form class."><!---->Step 1 - Creating a DoprDown Form class.<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#step-2-and-3-placing-a-components-on-the-form-and-writing-event-handlers" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Step 2 and 3 - Placing a components on the form and writing event handlers."><!---->Step 2 and 3 - Placing a components on the form and writing event handlers.<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#closing-the-form-and-transferring-the-selected-values" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Closing the Form and transferring the selected values"><!---->Closing the Form and transferring the selected values<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#tcustomdropdownformeh-formelements-property" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="TCustomDropDownFormEh.FormElements property"><!---->TCustomDropDownFormEh.FormElements property<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#step-4-â€“-customizing-the-calling-controls" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Step 4 â€“ Customizing the calling controls."><!---->Step 4 â€“ Customizing the calling controls.<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#step-4-1-assigning-parameters-from-edit-control-the-dropdown-form" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Step 4.1 Assigning parameters from edit control the DropDown Form."><!---->Step 4.1 Assigning parameters from edit control the DropDown Form.<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#example-of-using-dropdown-forms" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Example of using DropDown forms:"><!---->Example of using DropDown forms:<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/21-printing-components-of-library.html" class="nav-link sidebar-link sidebar-page" aria-label="Printing components of Library"><!---->Printing components of Library<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/22-export-library-components-to-pdf-file.html" class="nav-link sidebar-link sidebar-page" aria-label="Export library components to Pdf file"><!---->Export library components to Pdf file<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/23-generating-pdf-files-using-the-printer-class.html" class="nav-link sidebar-link sidebar-page" aria-label="Generating Pdf Files Using the Printer Class"><!---->Generating Pdf Files Using the Printer Class<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/24-view-properties-of-components-at-run-time.html" class="nav-link sidebar-link sidebar-page" aria-label="View properties of components at Run-Time"><!---->View properties of components at Run-Time<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/25-using-tpropstorageeh-components.html" class="nav-link sidebar-link sidebar-page" aria-label="TPropStorageEh component"><!---->TPropStorageEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/26-mem-table-and-data-driver.html" class="nav-link sidebar-link sidebar-page" aria-label="MemTable and DataDriver"><!---->MemTable and DataDriver<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TMemTableEh component</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/28-tdatadrivereh-component.html" class="nav-link sidebar-link sidebar-page" aria-label="TDataDriverEh component"><!---->TDataDriverEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDataDriverEh component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Components for consolidated data analysis</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Components for planning and event management</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Ð¡reating Xlsx files (TXlsMemFileEh class)</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/33-components-for-uploading-data-set-text.html" class="nav-link sidebar-link sidebar-page" aria-label="Components for uploading DataSet to a text file and load a text file"><!---->Components for uploading DataSet to a text file and load a text file<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/34-hiding-a-component-form-in-design-time.html" class="nav-link sidebar-link sidebar-page" aria-label="Hiding a component form in Design-Time"><!---->Hiding a component form in Design-Time<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/35-feedbacks-and-bug-reports.html" class="nav-link sidebar-link sidebar-page" aria-label="Feedbacks and bug reports"><!---->Feedbacks and bug reports<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->DropDownForms - custom drop-down windows</h1><div class="page-info"><span class="author-info" aria-label="AuthorðŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://www.ehlib.com" target="_blank" rel="noopener noreferrer">Admin</a></span><span property="author" content="Admin"></span></span><!----><!----><!----><!----><span class="reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 5 min</span><meta property="timeRequired" content="PT5M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">On This Page</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#step-1-creating-a-doprdown-form-class" class="router-link-active router-link-exact-active toc-link level3">Step 1 - Creating a DoprDown Form class.</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#step-2-and-3-placing-a-components-on-the-form-and-writing-event-handlers" class="router-link-active router-link-exact-active toc-link level3">Step 2 and 3 - Placing a components on the form and writing event handlers.</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#closing-the-form-and-transferring-the-selected-values" class="router-link-active router-link-exact-active toc-link level3">Closing the Form and transferring the selected values</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#tcustomdropdownformeh-formelements-property" class="router-link-active router-link-exact-active toc-link level3">TCustomDropDownFormEh.FormElements property</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#step-4-â€“-customizing-the-calling-controls" class="router-link-active router-link-exact-active toc-link level3">Step 4 â€“ Customizing the calling controls.</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#step-4-1-assigning-parameters-from-edit-control-the-dropdown-form" class="router-link-active router-link-exact-active toc-link level3">Step 4.1 Assigning parameters from edit control the DropDown Form.</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html#example-of-using-dropdown-forms" class="router-link-active router-link-exact-active toc-link level3">Example of using DropDown forms:</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="dropdownforms-custom-drop-down-windows" tabindex="-1"><a class="header-anchor" href="#dropdownforms-custom-drop-down-windows" aria-hidden="true">#</a> DropDownForms - custom drop-down windows</h1><p>Typical <code>DropDown</code> window - is a list that appears in the control <code>TComboBox</code> when you click on the edit button. New technology allows you to create a customizable drop-down windows that appears when user click on the button (<code>EditButton</code>) in <code>TDBEditEh</code>, <code>TDBNumberEditEh</code>, <code>TInplaceEditor</code> in <code>DBGridEh</code> etc. components.</p><p><img src="/online-help-vuepress-hope/assets/clip0005.4cb8740e.png" alt="" loading="lazy"></p><p>Follow next steps to create and use a DropDown Form:</p><ol><li>Create a <code>Form</code> that is inherited from <code>TCustomDropDownFormEh</code> class. This can be done at <code>Design-Time</code> through the menu <code>File-New-Other</code> ...-Tab &quot;EhLib Forms&quot;-&quot;DropDown Form&quot; item.</li><li>Create and arrange controls on the <code>Form</code>.</li><li>Write <code>Form</code> event handlers:</li></ol><p><code>OnInitForm</code> event - to get the parameters passed from the text editor and initiate the form according to the received parameters.</p><p><code>OnReturnParams</code> event - to store the selected value from the Form to the internal structure for the subsequent transmission to a text editor.</p><ol start="4"><li>It is necessary to assign the property <code>DropDownFormParams.DropDownForm</code> or <code>DropDownFormParams.DropDownFormClassName</code> in a text editor or edit button (<code>TDBEditEh</code>, <code>TDBNumberEditEh</code>, <code>DBGridEh.TColumnEh</code>), where are you going to call the <code>DropDown Form</code>, to indicate which <code>Form</code> should be called when a user clicks on the edit button.</li></ol><p>This is a sufficient minimum set of steps to make <code>DropDown Form</code> work at <code>Run-Time</code>.</p><p>By default, the text editor transmits the value as the first parameter in the Form and writes the resulting value of the first parameter transmitted from the <code>From</code> to itself text property.</p><p>Letâ€™s look at the steps of creating a <code>DropDown Forms</code> with more details.</p><h3 id="step-1-creating-a-doprdown-form-class" tabindex="-1"><a class="header-anchor" href="#step-1-creating-a-doprdown-form-class" aria-hidden="true">#</a> Step 1 - Creating a DoprDown Form class.</h3><p>When creating a <code>Form</code> through menu menu <code>File-New-Other</code> ...-Tab &quot;EhLib Forms&quot;-Element &quot;DropDown Form&quot; a system call a library code that creates a new <code>Form</code> that is inherited from <code>CustomDropDownFormEh</code> class.</p><p><img src="/online-help-vuepress-hope/assets/clip0006.e993a167.png" alt="" loading="lazy"></p><h3 id="step-2-and-3-placing-a-components-on-the-form-and-writing-event-handlers" tabindex="-1"><a class="header-anchor" href="#step-2-and-3-placing-a-components-on-the-form-and-writing-event-handlers" aria-hidden="true">#</a> Step 2 and 3 - Placing a components on the form and writing event handlers.</h3><p>At <code>Run-Time</code>, working with a <code>Form</code> resembles working with a dialog box in a <code>ShowModal</code> mode. However, the system closes the <code>DropDown Form</code> when the form loses it active state. You can also close the form in the code indicating that the Form must be closed with a &quot;Send the selected value to the calling control&quot; indication. In this case the event in the edit control would be caused to store the selected value. You can also customize that the edit control assigns a selected value to itself automatically. The Library calls an <code>TCustomDropDownFormEh.OnInitForm</code> event before showing the Form. It is necessary to initialize the <code>Form</code> before displaying and use the transferred data from the caller control.</p><p>Here is an example of event handler for <code>OnInitForm</code> event:</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">procedure</span> TDropDownMemoEdit1<span class="token punctuation">.</span>CustomDropDownFormEhInitForm<span class="token punctuation">(</span>
  Sender<span class="token punctuation">:</span> TCustomDropDownFormEh<span class="token punctuation">;</span> DynParams<span class="token punctuation">:</span> TDynVarsEh<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>
  <span class="token keyword">if</span> DynParams<span class="token punctuation">.</span>Count <span class="token operator">&gt;=</span> <span class="token number">1</span> <span class="token keyword">then</span>
    Memo1<span class="token punctuation">.</span>Lines<span class="token punctuation">.</span>Text <span class="token operator">:=</span> DynParams<span class="token punctuation">.</span>Items<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>AsString<span class="token punctuation">;</span>

  sbOk<span class="token punctuation">.</span>Enabled <span class="token operator">:=</span> <span class="token operator">not</span> ReadOnly<span class="token punctuation">;</span>
  Memo1<span class="token punctuation">.</span>ReadOnly <span class="token operator">:=</span> ReadOnly<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the above code the check is performed, whether any value was transferred from the <code>Control</code> through the <code>DynParams</code> parameter. If it was transferred, the value is assigned to a <code>Memo1</code>.</p><p><code>DropDown Form</code> may be in of <code>ReadOnly</code>. This property is assigned by the transmission control depending of <code>Control.Field.ReadOnly</code> value. In the above code, we adjust components of the form according to the state <code>ReadOnly</code>. Consider that a <code>ReadOnly</code> form will not return any value, and will only be opened to view the data.</p><h3 id="closing-the-form-and-transferring-the-selected-values" tabindex="-1"><a class="header-anchor" href="#closing-the-form-and-transferring-the-selected-values" aria-hidden="true">#</a> Closing the Form and transferring the selected values</h3><p>Assign <code>ModalResult</code> property by <code>mrOk</code> to close the Form with the &quot;Transfer selected value&quot; indication. Below is a code sample that closes the Form:</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">procedure</span> TDropDownMemoEdit<span class="token punctuation">.</span>sbOkClick<span class="token punctuation">(</span>Sender<span class="token punctuation">:</span> TObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>  
  ModalResult <span class="token operator">:=</span> mrOk<span class="token punctuation">;</span>
  Close<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The program will close the Form and call <code>OnReturnParams</code> event to transfer the selected values in the internal variables. By default, the system offers to write the selected values in the <code>DynVars</code> array that is passed as a parameter.</p><p>Below is an example of an <code>OnReturnParams</code> event handler:</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">procedure</span> TDropDownMemoEdit1<span class="token punctuation">.</span>CustomDropDownFormEhReturnParams<span class="token punctuation">(</span>
  Sender<span class="token punctuation">:</span> TCustomDropDownFormEh<span class="token punctuation">;</span> DynParams<span class="token punctuation">:</span> TDynVarsEh<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>
  DynParams<span class="token punctuation">.</span>Items<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>AsString <span class="token operator">:=</span> Memo1<span class="token punctuation">.</span>Lines<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In our case, we write the text from a <code>TMemo</code> to the first item of a <code>DynParams</code> collection. The collection will already contain an element, as we have already passed it in the Form using the same collection (This part will be discussed later in the part of customizing the edit control).</p><h3 id="tcustomdropdownformeh-formelements-property" tabindex="-1"><a class="header-anchor" href="#tcustomdropdownformeh-formelements-property" aria-hidden="true">#</a> TCustomDropDownFormEh.FormElements property</h3><p><code>TCustomDropDownFormEh</code> class has a property to define of displaying additional special controls on the <code>Form</code>. Use <code>FormElements</code> property to specify which additional items have to be placed on the Form in the Run-Time:</p><p><code>ddfeLeftGripEh</code> â€“ SizeGrip control in the left corner. This element is used to change a window size.</p><p><code>ddfeRightGripEh</code> â€“ SizeGrip element in the right corner of the window.</p><p><code>ddfeCloseButtonEh</code> â€“ Close button.</p><p><code>ddfeSizingBarEh</code> â€“ The bar at the bottom of the window to change the height of the window by mouse.</p><p><img src="/online-help-vuepress-hope/assets/clip0007.263c0117.png" alt="" loading="lazy"></p><h3 id="step-4-â€“-customizing-the-calling-controls" tabindex="-1"><a class="header-anchor" href="#step-4-â€“-customizing-the-calling-controls" aria-hidden="true">#</a> Step 4 â€“ Customizing the calling controls.</h3><p>There are a <code>DropDownFormParams</code> property in the classes that work with text editors, such as <code>TColumnEh</code>, <code>TDBEditEh</code> etc.,. This property contains sub-properties to configure a <code>DropDown Form</code>: to define which form must be shown, how to pass and get parameters to/form the From.</p><p>Use the property <code>DropDownFormParams.DropDownForm</code> or <code>DropDownFormParams</code>. <code>DropDownFormClassName</code> to specify the name of the form to be displayed when a user clicks on the <code>EditButton</code>.</p><p>If <code>DropDownFormParams.DropDownForm</code> property is assigned then the <code>Form</code> must be created in advance and assigned to a global variable <code>&lt;DropDownFormName: TDropDownFormName&gt;</code>, which is created by the project code when creating forms. This creation and assignment occurs automatically when the form is in the list of Â«Auto-create formsÂ» (see Project properties).</p><p>If <code>DropDownFormParams.DropDownFormClassName</code> property is assigned then the program will create a form just before showing and destroy it after the Form is closed. To allow the program to find the form designer by the name of the class, form class must be registered using procedure <code>Classes.RegisterClass</code>.</p><p>This can be done in the initialization part of DropDown Form unit. Below is an example of registering a class:</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">unit</span> MyDropDownFormUnit1<span class="token punctuation">;</span>
â€¦
<span class="token keyword">interface</span>
â€¦
<span class="token keyword">initialization</span>
  RegisterClass<span class="token punctuation">(</span>TMyDropDownForm1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>There is another way to create a DropDown Form. Form is created before the first display and lives up to the end of the life of the program. To implement this method follow the next steps:</p><ul><li>Assign the <code>DropDownFormParams.DropDownFormClassName</code> property</li><li>Register the class of the Form using <code>RegisterClass</code> (TMyDropDownForm1) code.</li><li>Override the virtual <code>class function TCustomDropDownFormEh.GetGlobalRef: TCustomDropDownFormEh</code> â€“ to create Form on the first call and assigns it to a global variable.</li></ul><p>Below is the sample of code that implements this functionality:</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">type</span>
  TDropDownMemoEdit3 <span class="token operator">=</span> <span class="token keyword">class</span><span class="token punctuation">(</span>TCustomDropDownFormEh<span class="token punctuation">)</span>
â€¦
  <span class="token keyword">public</span>
    <span class="token keyword">class</span> <span class="token keyword">function</span> GetGlobalRef<span class="token punctuation">:</span> TCustomDropDownFormEh<span class="token punctuation">;</span> <span class="token keyword">override</span><span class="token punctuation">;</span>
  <span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token keyword">var</span>
  DropDownMemoEdit3<span class="token punctuation">:</span> TDropDownMemoEdit3<span class="token punctuation">;</span>

<span class="token keyword">implementation</span>
â€¦
<span class="token keyword">class</span> <span class="token keyword">function</span> TDropDownMemoEdit3<span class="token punctuation">.</span>GetGlobalRef<span class="token punctuation">:</span> TCustomDropDownFormEh<span class="token punctuation">;</span>
<span class="token keyword">begin</span>
  <span class="token keyword">if</span> DropDownMemoEdit3 <span class="token operator">=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
    Application<span class="token punctuation">.</span>CreateForm<span class="token punctuation">(</span>TDropDownMemoEdit3<span class="token punctuation">,</span> DropDownMemoEdit3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">Result</span> <span class="token operator">:=</span> DropDownMemoEdit3<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
â€¦
<span class="token keyword">end</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="step-4-1-assigning-parameters-from-edit-control-the-dropdown-form" tabindex="-1"><a class="header-anchor" href="#step-4-1-assigning-parameters-from-edit-control-the-dropdown-form" aria-hidden="true">#</a> Step 4.1 Assigning parameters from edit control the DropDown Form.</h3><p>Use <code>DropDownFormParams.PassParams</code> property to specify which field values must be passed in the drop-down Form. The property can hold one of the next values:</p><p><code>pspByFieldNamesEh</code> - Pass the value of the fields specified in the property DropDownFormParams. PassFieldNames</p><p><code>pspFieldValueEh</code> - Pass the current value of the edit control.</p><p><code>pspRecordValuesEh</code> - Pass the value of all the fields of the current DataSet record.</p><p>In the drop-down form, you can read the transferred value form DynParams collection.</p><p>DropDownFormParams property contains the following sub-properties:</p><p>Property Name Property Type Description <code>DropDownForm: TCustomForm</code> Reference to a DropDown Form.</p><p><code>DropDownFormClassName: String</code> Reference to a class that implements DropDown Form.</p><p><code>Align: TDropDownAlign</code> Alignment of the DropDown Form relative to the edit control.</p><p><code>PassParams: TDropDownPassParamsEh</code> Way of passing the parameters.</p><p><code>PassFieldNames: String</code> The name of the DataSet fields, the value of which should be passed in the Form.</p><p><code>AssignBackFieldNames: String</code> The name of the DataSet field, the value of which assigned to the values received from the Form.</p><p><code>FormWidth: Integer</code> Width of the Form. The Form width is written to the property when the Form is closed.</p><p><code>FormHeight: Integer</code> The height of the form. The Form height is written to the property when the Form is closed.</p><p><code>SaveFormSize: Boolean</code> The property determines whether to keep the size of the form in the FormWidth and FormHeight properties.</p><h3 id="example-of-using-dropdown-forms" tabindex="-1"><a class="header-anchor" href="#example-of-using-dropdown-forms" aria-hidden="true">#</a> Example of using DropDown forms:</h3><p>Examples of using and working with DropDownForms see at the Demo Project: <code>&lt;EhLib Archive&gt;\Demos\DropDownForm\Project1.dpr</code></p><p>compiled project: <code>&lt;EhLib Archive&gt;\Demos\Bin\DropDownForm.Exe</code></p><p>New properties in classes of the library for working with DropDown Forms: New properties to customize the display drop-down forms appeared in the next classes:</p><p>(For DBGridEh)</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>TColumnEh.DropDownFormParams
TColumnEh.EditButtons[i].DropDownFormParams
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>(For DBVertGridEh)</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>TFieldRowEh.DropDownFormParams
TFieldRowEh.EditButtons[i].DropDownFormParams
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>TDBEditEh.EditButton.DropDownFormParams
TDBEditEh.EditButtons[i].DropDownFormParams
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>In <code>EditButtons</code> for <code>TDBNumberEditEh</code>, <code>TDBDateTimeEditEh</code>, <code>TDBComboBoxEh</code>, <code>TDBLookupComboBoxEh</code> controls.</p></div><!----><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><!----><a href="/online-help-vuepress-hope/EhLibDoc/21-printing-components-of-library.html" class="nav-link next" aria-label="Printing components of Library"><div class="hint">Next<span class="arrow right"></span></div><div class="link">Printing components of Library<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/online-help-vuepress-hope/assets/app.ac77cf73.js" defer></script>
  </body>
</html>
