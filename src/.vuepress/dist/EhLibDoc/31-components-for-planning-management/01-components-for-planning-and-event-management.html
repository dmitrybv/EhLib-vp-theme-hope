<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.53" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html"><meta property="og:site_name" content="EhLib.VCL Developer’s guide"><meta property="og:title" content="Components for planning and visual interactive event management"><meta property="og:description" content="The library contains a set of components for planning and visual interactive control events tied to a specific period of time. Component TPlannerDataSourceEh TPlannerDataSourceE..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><link rel="icon" href="/online-help-vuepress-hope/favicon.ico"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/online-help-vuepress-hope/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/online-help-vuepress-hope/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/online-help-vuepress-hope/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/online-help-vuepress-hope/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>Components for planning and visual interactive event management | EhLib.VCL Developer’s guide</title><meta name="description" content="The library contains a set of components for planning and visual interactive control events tied to a specific period of time. Component TPlannerDataSourceEh TPlannerDataSourceE...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/online-help-vuepress-hope/assets/style.c7186ee6.css" as="style" /><link rel="stylesheet" href="/online-help-vuepress-hope/assets/style.c7186ee6.css" />
    <link rel="modulepreload" href="/online-help-vuepress-hope/assets/app.ac77cf73.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/01-components-for-planning-and-event-management.html.686b385f.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/online-help-vuepress-hope/assets/01-components-for-planning-and-event-management.html.cbca7fd7.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/online-help-vuepress-hope/" class="brand"><img class="logo" src="/online-help-vuepress-hope/EhLib.Logo.Text.png" alt="EhLib.VCL Developer’s guide"><!----><span class="site-name hide-in-pad">EhLib.VCL Developer’s guide</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!----><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><!----><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><div class="search-pro-button" role="search" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg></div><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading clickable active"><!----><a href="/online-help-vuepress-hope/EhLibDoc/" class="title"></a><!----></p><ul class="sidebar-links"><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/00-content.html" class="nav-link sidebar-link sidebar-page" aria-label="Content"><!---->Content<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/01-introduction.html" class="nav-link sidebar-link sidebar-page" aria-label="Introduction"><!---->Introduction<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/02-specifications.html" class="nav-link sidebar-link sidebar-page" aria-label="Specification"><!---->Specification<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/03-installing.html" class="nav-link sidebar-link sidebar-page" aria-label="Installing"><!---->Installing<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/04-list-of-components-and-classes.html" class="nav-link sidebar-link sidebar-page" aria-label="List of components and classes"><!---->List of components and classes<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/05-language-resources.html" class="nav-link sidebar-link sidebar-page" aria-label="Language resources"><!---->Language resources<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDBGridEh Component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TPrintDBGridEh component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDBVertGridEh component</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/13-using-tdbsumlist-component.html" class="nav-link sidebar-link sidebar-page" aria-label="Using TDBSumList component"><!---->Using TDBSumList component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Edit controls</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/20-drop-down-forms.html" class="nav-link sidebar-link sidebar-page" aria-label="DropDownForms - custom drop-down windows"><!---->DropDownForms - custom drop-down windows<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/21-printing-components-of-library.html" class="nav-link sidebar-link sidebar-page" aria-label="Printing components of Library"><!---->Printing components of Library<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/22-export-library-components-to-pdf-file.html" class="nav-link sidebar-link sidebar-page" aria-label="Export library components to Pdf file"><!---->Export library components to Pdf file<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/23-generating-pdf-files-using-the-printer-class.html" class="nav-link sidebar-link sidebar-page" aria-label="Generating Pdf Files Using the Printer Class"><!---->Generating Pdf Files Using the Printer Class<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/24-view-properties-of-components-at-run-time.html" class="nav-link sidebar-link sidebar-page" aria-label="View properties of components at Run-Time"><!---->View properties of components at Run-Time<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/25-using-tpropstorageeh-components.html" class="nav-link sidebar-link sidebar-page" aria-label="TPropStorageEh component"><!---->TPropStorageEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/26-mem-table-and-data-driver.html" class="nav-link sidebar-link sidebar-page" aria-label="MemTable and DataDriver"><!---->MemTable and DataDriver<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TMemTableEh component</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/28-tdatadrivereh-component.html" class="nav-link sidebar-link sidebar-page" aria-label="TDataDriverEh component"><!---->TDataDriverEh component<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">TDataDriverEh component</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Components for consolidated data analysis</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-stack"></span><span class="title">Components for planning and event management</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/00-content.html" class="nav-link sidebar-link sidebar-page" aria-label="Components for planning and visual interactive event management"><!---->Components for planning and visual interactive event management<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Components for planning and visual interactive event management"><!---->Components for planning and visual interactive event management<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#using-the-context-menu-in-the-components-plannerview" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Using the context menu in the components PlannerView"><!---->Using the context menu in the components PlannerView<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#list-of-plannerview-events" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="List of PlannerView events:"><!---->List of PlannerView events:<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#component-tplannercalendarpickereh" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Component TPlannerCalendarPickerEh"><!---->Component TPlannerCalendarPickerEh<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#loading-elements-events-from-db-or-another-storage" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Loading elements-events from DB or another storage."><!---->Loading elements-events from DB or another storage.<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#uploading-of-changed-elements-to-database" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Uploading of changed elements to DataBase."><!---->Uploading of changed elements to DataBase.<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#resources-and-events" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Resources and events."><!---->Resources and events.<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/02-printing-of-tplannercontroleh.html" class="nav-link sidebar-link sidebar-page" aria-label="Printing of TPlannerControlEh"><!---->Printing of TPlannerControlEh<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/03-show-hint-winow-for-planner-items.html" class="nav-link sidebar-link sidebar-page" aria-label="Show Hint Winow for planner Items"><!---->Show Hint Winow for planner Items<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-stack"></span><span class="title">Сreating Xlsx files (TXlsMemFileEh class)</span><span class="arrow right"></span></button><!----></section></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/33-components-for-uploading-data-set-text.html" class="nav-link sidebar-link sidebar-page" aria-label="Components for uploading DataSet to a text file and load a text file"><!---->Components for uploading DataSet to a text file and load a text file<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/34-hiding-a-component-form-in-design-time.html" class="nav-link sidebar-link sidebar-page" aria-label="Hiding a component form in Design-Time"><!---->Hiding a component form in Design-Time<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/online-help-vuepress-hope/EhLibDoc/35-feedbacks-and-bug-reports.html" class="nav-link sidebar-link sidebar-page" aria-label="Feedbacks and bug reports"><!---->Feedbacks and bug reports<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Components for planning and visual interactive event management</h1><div class="page-info"><span class="author-info" aria-label="Author🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://www.ehlib.com" target="_blank" rel="noopener noreferrer">Admin</a></span><span property="author" content="Admin"></span></span><!----><!----><!----><!----><span class="reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 5 min</span><meta property="timeRequired" content="PT5M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">On This Page</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#using-the-context-menu-in-the-components-plannerview" class="router-link-active router-link-exact-active toc-link level3">Using the context menu in the components PlannerView</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#list-of-plannerview-events" class="router-link-active router-link-exact-active toc-link level3">List of PlannerView events:</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#component-tplannercalendarpickereh" class="router-link-active router-link-exact-active toc-link level3">Component TPlannerCalendarPickerEh</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#loading-elements-events-from-db-or-another-storage" class="router-link-active router-link-exact-active toc-link level3">Loading elements-events from DB or another storage.</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#uploading-of-changed-elements-to-database" class="router-link-active router-link-exact-active toc-link level3">Uploading of changed elements to DataBase.</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/01-components-for-planning-and-event-management.html#resources-and-events" class="router-link-active router-link-exact-active toc-link level3">Resources and events.</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="components-for-planning-and-visual-interactive-event-management" tabindex="-1"><a class="header-anchor" href="#components-for-planning-and-visual-interactive-event-management" aria-hidden="true">#</a> Components for planning and visual interactive event management</h1><p>The library contains a set of components for planning and visual interactive control events tied to a specific period of time.</p><h5 id="component-tplannerdatasourceeh" tabindex="-1"><a class="header-anchor" href="#component-tplannerdatasourceeh" aria-hidden="true">#</a> Component TPlannerDataSourceEh</h5><p>TPlannerDataSourceEh component is used for storing TPlannerDataItemEh objects-events.</p><h5 id="component-tplannercontroleh" tabindex="-1"><a class="header-anchor" href="#component-tplannercontroleh" aria-hidden="true">#</a> Component TPlannerControlEh.</h5><p>The visual component-container TPlannerControlEh contains a set of PlannerView visual components. Each of the PlannerView components displays period of time and events on it in a specific format. On screenshot on the left side TPlannerControlEh component contains PlannerView of TPlannerDayViewEh type, which displays a set of events for one day.</p><p><img src="/online-help-vuepress-hope/assets/clip0068.97a27d82.png" alt="" loading="lazy"></p><p>In current version PlannerView elements can have one of the following types:</p><ul><li><code>TPlannerDayViewEh</code> Displays an interval of time one day long and events fall into it.</li><li><code>TPlannerWeekViewEh</code> Displays an interval of time one week long and events fall into it.</li><li><code>TPlannerMonthViewEh</code> Displays an interval of time one month long and events fall into it.</li><li><code>TPlannerVertDayslineViewEh</code> Displays an interval of time of different length in vertical orientation with cells length of one day.</li><li><code>TPlannerVertHourslineViewEh</code> Displays an interval of time of different length in vertical orientation with cells length of one hour.</li><li><code>TPlannerHorzHourslineViewEh</code> Displays an interval of time of different length in horizontal orientation with cells length of one day.</li><li><code>TPlannerHorzDayslineViewEh</code> Displays an interval of time of different length in horizontal orientation with cells length of one hour.</li><li><code>TPlannerHorzYearViewEh</code> Displays a one-year time long in horizontal orientation with one-day cells.</li></ul><p><code>TPlannerControlEh</code> component contains PlannerView components by analogy as a <code>PageControl</code> standard component contains a set of TabSheets bookmarks.</p><p>Time divider of 5, 6, 10, 15, 30 and 60 minutes in <code>TPlannerDayViewEh</code> and <code>TPlannerWeekViewEh</code> components</p><p>In <code>TPlannerDayViewEh</code> and <code>TPlannerWeekViewEh</code> controls a <code>BarTimeInterval</code> property was added. The property have <code>TPlannerBarTimeIntervalEh</code> type.</p><p><code>TPlannerBarTimeIntervalEh = (pbti5MinEh, pbti6MinEh, pbti10MinEh, pbti15MinEh, pbti30MinEh, pbti60MinEh);</code></p><p>The property specifies the length (In minutes) of one time data row in the PlannerView.</p><h3 id="using-the-context-menu-in-the-components-plannerview" tabindex="-1"><a class="header-anchor" href="#using-the-context-menu-in-the-components-plannerview" aria-hidden="true">#</a> Using the context menu in the components PlannerView</h3><p>All components such as PlannerView have <code>PopupMenu</code> property and <code>OnContextPopup</code> event. Context Menu is defined by <code>PlannerView.PopupMenu</code> property. <code>PopupMenu</code> is displayed when user right-click on any cell of <code>PlannerView</code> control.</p><p>In addition to the functional of component thera are properties and events to display the context menu when the user clicked the right mouse button over the SpanItem element.</p><p>In this case, use <code>PlannerControl.TimeSpanParams.PopupMenu</code> property and <code>PlannerControl.OnPlannerSpanItemContextPopup</code> event.</p><h3 id="list-of-plannerview-events" tabindex="-1"><a class="header-anchor" href="#list-of-plannerview-events" aria-hidden="true">#</a> List of PlannerView events:</h3><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">property</span> OnContextPopup<span class="token punctuation">:</span> TContextPopupEvent<span class="token punctuation">;</span>

TContextPopupEvent <span class="token operator">=</span> <span class="token keyword">procedure</span><span class="token punctuation">(</span>Sender<span class="token punctuation">:</span> TObject<span class="token punctuation">;</span> 
  MousePos<span class="token punctuation">:</span> TPoint<span class="token punctuation">;</span> <span class="token keyword">var</span> Handled<span class="token punctuation">:</span> Boolean<span class="token punctuation">)</span> <span class="token keyword">of</span> <span class="token keyword">object</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><dd><p>The event is called before context Menu is shown. In the event you can set up the context menu items before displaying. In the event you can display the context menu in your code and set the Handled parameter to True. For example of event handle, see the demo project <code>&lt;EhLib archive&gt;\Demos\PlannerEh.MainDemo\</code>, in FrameOne.pas module.</p></dd><br><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">property</span> OnDrawCell<span class="token punctuation">:</span>  TPlannerViewDrawCellEventEh<span class="token punctuation">;</span>

TPlannerViewDrawCellEventEh <span class="token operator">=</span> <span class="token keyword">procedure</span> <span class="token punctuation">(</span>PlannerView<span class="token punctuation">:</span> TCustomPlannerViewEh<span class="token punctuation">;</span>
    ACol<span class="token punctuation">,</span> ARow<span class="token punctuation">:</span> Integer<span class="token punctuation">;</span> ARect<span class="token punctuation">:</span> TRect<span class="token punctuation">;</span> State<span class="token punctuation">:</span> TGridDrawState<span class="token punctuation">;</span>
    CellType<span class="token punctuation">:</span> TPlannerViewCellTypeEh<span class="token punctuation">;</span> ALocalCol<span class="token punctuation">,</span> ALocalRow<span class="token punctuation">:</span> Integer<span class="token punctuation">;</span>
    ADrawCellArgs<span class="token punctuation">:</span> TPlannerViewCellDrawArgsEh<span class="token punctuation">;</span> <span class="token keyword">var</span> Processed<span class="token punctuation">:</span> Boolean<span class="token punctuation">)</span> <span class="token keyword">of</span> <span class="token keyword">object</span><span class="token punctuation">;</span>
</code></pre></div><dd> Event is called before rendering PlannerView cell. In the event you can change the cell drawing parameters by setting new values in ADrawCellArgs parameter. In the event you can draw the contents of the cell using the methods of PlannerView.Canvas class and set the Processed to True. </dd><br><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">property</span> OnReadPlannerDataItem<span class="token punctuation">:</span> TPlannerViewReadDataItemEventEh   

TPlannerViewReadDataItemEventEh <span class="token operator">=</span> <span class="token keyword">procedure</span> <span class="token punctuation">(</span>PlannerControl<span class="token punctuation">:</span> TPlannerControlEh<span class="token punctuation">;</span>
PlannerView<span class="token punctuation">:</span> TCustomPlannerViewEh<span class="token punctuation">;</span> 
DataItem<span class="token punctuation">:</span> TPlannerDataItemEh<span class="token punctuation">;</span> 
<span class="token keyword">var</span> ReadDataItem<span class="token punctuation">:</span> Boolean<span class="token punctuation">)</span> <span class="token keyword">of</span> <span class="token keyword">object</span><span class="token punctuation">;</span>
</code></pre></div><dd> This event is fired when reading data of TPlannerDataItemEh from DataSoruce to PlannerView. In the event handler you can determine whether you want to read a particular item / event from PlannerDataSourceEh. Set the value to False to prevent ReadDataItem from reading. </dd><br><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">property</span> OnSelectionChanged<span class="token punctuation">:</span> TNotifyEvent<span class="token punctuation">;</span> 
</code></pre></div><dd>The event is fired when the current selected TPlannerDataItemEh element is changed. In the event you can update the status of the buttons or menu items that dependent on the selected item in TPlannerDataItemEh PlannerView.</dd><br><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">property</span> OnSpanItemHintShow<span class="token punctuation">:</span> TPlannerViewSpanItemHintShowEventEh

  TPlannerViewSpanItemHintShowEventEh <span class="token operator">=</span> <span class="token keyword">procedure</span><span class="token punctuation">(</span>PlannerControl<span class="token punctuation">:</span> TPlannerControlEh<span class="token punctuation">;</span>
    PlannerView<span class="token punctuation">:</span> TCustomPlannerViewEh<span class="token punctuation">;</span> 
    CursorPos<span class="token punctuation">:</span> TPoint<span class="token punctuation">;</span> SpanRect<span class="token punctuation">:</span> TRect<span class="token punctuation">;</span>
    InSpanCursorPos<span class="token punctuation">:</span> TPoint<span class="token punctuation">;</span> 
    SpanItem<span class="token punctuation">:</span> TTimeSpanDisplayItemEh<span class="token punctuation">;</span>
    Params<span class="token punctuation">:</span> TPlannerViewSpanHintParamsEh<span class="token punctuation">;</span> 
    <span class="token keyword">var</span> Processed<span class="token punctuation">:</span> Boolean<span class="token punctuation">)</span> <span class="token keyword">of</span> <span class="token keyword">object</span><span class="token punctuation">;</span>
</code></pre></div><p>Write the event handler to change the text, font or background in the window display tips. This event is fired when prompted to SpanItem element. For more information about the event, see the section – «Show Hint Winow for planner Items».</p><h3 id="component-tplannercalendarpickereh" tabindex="-1"><a class="header-anchor" href="#component-tplannercalendarpickereh" aria-hidden="true">#</a> Component TPlannerCalendarPickerEh</h3><p>The visual component- calendar is designed to navigate through days of a month. On select a date in the calendar, the component automatically sets the current day in tied <code>TPlannerControlEh</code> component. For bundles of two components using the property type <code>TPlannerCalendarPickerEh.PlannerControl</code> TPlannerControlEh.</p><p>For linking two components use <code>TPlannerCalendarPickerEh.PlannerControl</code> property of <code>TPlannerControlEh</code> type.</p><p>On changing the current period directly in <code>TPlannerControlEh</code> or through <code>TPlannerCalendarPickerEh</code>, component <code>PlannerControl</code> each time refers to the <code>TPlannerDataSourceEh</code> tied component to get a list of <code>TPlannerDataItemEh</code> objects-events for the required period.</p><p>Communication of <code>PlannerControl</code> and <code>PlannerDataSource</code> components performs through <code>TPlannerControlEh.TimePlanSource</code> property of <code>TPlannerDataSourceEh</code> type.</p><p><img src="/online-help-vuepress-hope/assets/clip0070.4f9b44ce.png" alt="" loading="lazy"></p><p><code>TPlannerCalendarPickerEh</code> have the has the following features:</p><ul><li>Allows to highlight the holidays and weekends.</li><li>Allows to highlight current day.</li><li>Allows to display a link to today.</li></ul><h3 id="loading-elements-events-from-db-or-another-storage" tabindex="-1"><a class="header-anchor" href="#loading-elements-events-from-db-or-another-storage" aria-hidden="true">#</a> Loading elements-events from DB or another storage.</h3><p>Data about events is loaded into <code>TPlannerDataSourceEh</code> in the program code similar to the following example:</p><p>PlanItem := PlannerDataSourceEh1.NewItem(); PlanItem.ItemID := MyDataSet1[&#39;Id&#39;]; PlanItem.StartTime := MyDataSet1[&#39;StartTime&#39;]; ... PlannerDataSource.FetchTimePlanItem(PlanItem);</p><p>You are reading event data from the database into an internal <code>DataSet</code>. In the cycle by using a <code>NewItem.TPlannerDataItemEh</code> method the plan element is created. Fill properties of element. Element is recorded in an event collection by <code>FetchTimePlanItem</code> method.</p><p>Another way of data loading – through binding of DataSet and fields of DataSet. For binding setup use sub-properties of <code>TPlannerDataSourceEh.ItemSourceParams</code> property.</p><p>Set the <code>TPlannerDataSourceEh.ItemSourceParams.DataSet</code> property to <code>DataSet</code> which should be used to load data from. Fill <code>TPlannerDataSourceEh.ItemSourceParams.FieldsMap</code> collection with <code>TItemSourceFieldsMapItemEh</code> elements to set link between DataSet field and property of TPlannerDataItemEh element-event.</p><p><code>TPlannerDataItemEh</code> class has the following properties:</p><p><code>property Title: String;</code></p><dd>The property specifies the event title or plan element.</dd><br><p><code>property Body: String;</code></p><dd>The property specifies the detailed description of the event or plan element.</dd><br><p><code>property StartTime: TDateTime;</code></p><dd>The property sets the commencement of the event.</dd><br><p><code>property EndTime: TDateTime;</code></p><dd>The property sets the expiration date of the event.</dd><br><p><code>property AllDay: Boolean;</code></p><dd>Property indicates that the event lasts all day.</dd><br><p><code>property ResourceID: Variant;</code></p><dd>The property specifies the link to the resource is assigned to the event. List PlannerDataSourceEh.Resources resources stored in the collection. Before downloading the event are encouraged to download a list of resources from your database similar to the onload event.</dd><br><p><code>property ItemID: Variant;</code></p><dd>Event ID. The identifier is proposed to use a unique key in the table that you keep a list of events on the side of the database.</dd><br><p><code>property FillColor: TColor;</code></p><dd>The color of the event. You can set the default color to Default.</dd><br><p><code>property ReadOnly: Boolean;</code></p><dd>The property specifies that the user is not allowed to modify the contents or move the timeline event.</dd><br><h3 id="uploading-of-changed-elements-to-database" tabindex="-1"><a class="header-anchor" href="#uploading-of-changed-elements-to-database" aria-hidden="true">#</a> Uploading of changed elements to DataBase.</h3><p>On any change of an element of <code>PlannerDataItem</code> event <code>TPlannerDataSourceEh</code> component calls <code>OnApplyUpdateToDataStorage</code> event where it is necessary to write a code for transfering properties of changed <code>PlannerDataItem</code> element to the database.</p><p>The event code can look as follows:</p><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code>TimePlanSource<span class="token punctuation">:</span> TPlannerDataSourceEh<span class="token punctuation">;</span> PlanItem<span class="token punctuation">:</span> TPlannerDataItemEh<span class="token punctuation">;</span>
  UpdateStatus<span class="token punctuation">:</span> TUpdateStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>
  <span class="token keyword">if</span> UpdateStatus <span class="token operator">=</span> usModified <span class="token keyword">then</span>
  <span class="token keyword">begin</span>
    <span class="token keyword">if</span> mtPlannerData<span class="token punctuation">.</span>Locate<span class="token punctuation">(</span><span class="token string">&#39;Id&#39;</span><span class="token punctuation">,</span> PlanItem<span class="token punctuation">.</span>ItemID<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
    <span class="token keyword">begin</span>
      mtPlannerData<span class="token punctuation">.</span>Edit<span class="token punctuation">;</span>
      mtPlannerData<span class="token punctuation">[</span><span class="token string">&#39;StartTime&#39;</span><span class="token punctuation">]</span> <span class="token operator">:=</span> PlanItem<span class="token punctuation">.</span>StartTime<span class="token punctuation">;</span>
      mtPlannerData<span class="token punctuation">[</span><span class="token string">&#39;EndTime&#39;</span><span class="token punctuation">]</span> <span class="token operator">:=</span> PlanItem<span class="token punctuation">.</span>EndTime<span class="token punctuation">;</span>
      mtPlannerData<span class="token punctuation">[</span><span class="token string">&#39;Title&#39;</span><span class="token punctuation">]</span> <span class="token operator">:=</span> PlanItem<span class="token punctuation">.</span>Title<span class="token punctuation">;</span>
      mtPlannerData<span class="token punctuation">[</span><span class="token string">&#39;Body&#39;</span><span class="token punctuation">]</span> <span class="token operator">:=</span> PlanItem<span class="token punctuation">.</span>Body<span class="token punctuation">;</span>
      mtPlannerData<span class="token punctuation">[</span><span class="token string">&#39;AllDay&#39;</span><span class="token punctuation">]</span> <span class="token operator">:=</span> PlanItem<span class="token punctuation">.</span>AllDay<span class="token punctuation">;</span>
      mtPlannerData<span class="token punctuation">[</span><span class="token string">&#39;ResourceID&#39;</span><span class="token punctuation">]</span> <span class="token operator">:=</span> PlanItem<span class="token punctuation">.</span>ResourceID<span class="token punctuation">;</span>
      mtPlannerData<span class="token punctuation">.</span>Post<span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">else</span>
      <span class="token keyword">raise</span> Exception<span class="token punctuation">.</span>Create<span class="token punctuation">(</span><span class="token string">&#39;Can&#39;&#39; locate record with &quot;Id&quot;=&#39;</span> <span class="token operator">+</span> 
                             VarToStrDef<span class="token punctuation">(</span>PlanItem<span class="token punctuation">.</span>ItemID<span class="token punctuation">,</span> <span class="token string">&#39;&lt;Null&gt;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In this example changed data in <code>PlanItem</code> event is transferred to the TMemTableEh (TDataSet) - mtPlannerData.</p><h3 id="resources-and-events" tabindex="-1"><a class="header-anchor" href="#resources-and-events" aria-hidden="true">#</a> Resources and events.</h3><p><code>TPlannerDataSourceEh</code> component also contains the concept of resources. Each event can be linked to one of the resources from the collection of resources. If the list of events is the list of tasks which should be performed by a person, then list of resources is list of people one of which can be assigned to perform a specific task.</p><p>To access the elements of the collection use a sub-properties of <code>TPlannerDataSourceEh.Resources</code> property.</p><p>Typically, a collection of resources is filled before completing the collection of <code>PlanItem</code> events.</p><p>Filling the collection of resources is done in the code like this</p><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">with</span> TimePlanSourceEh1<span class="token punctuation">.</span>Resources<span class="token punctuation">.</span>Add <span class="token keyword">do</span>
<span class="token keyword">begin</span>
  <span class="token keyword">Name</span> <span class="token operator">:=</span> mtResource<span class="token punctuation">.</span>FieldByName<span class="token punctuation">(</span><span class="token string">&#39;Name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AsString<span class="token punctuation">;</span>
  ResourceID <span class="token operator">:=</span> i<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span> 
</code></pre></div><p>See demo project in the folder <code>&lt;EhLib Archive&gt;/DEMOS/PlannerEh.MainDemo</code></p></div><!----><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><a href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/00-content.html" class="nav-link prev" aria-label="Components for planning and visual interactive event management"><div class="hint"><span class="arrow left"></span>Prev</div><div class="link"><!---->Components for planning and visual interactive event management</div></a><a href="/online-help-vuepress-hope/EhLibDoc/31-components-for-planning-management/02-printing-of-tplannercontroleh.html" class="nav-link next" aria-label="Printing of TPlannerControlEh"><div class="hint">Next<span class="arrow right"></span></div><div class="link">Printing of TPlannerControlEh<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/online-help-vuepress-hope/assets/app.ac77cf73.js" defer></script>
  </body>
</html>
