import{_ as n}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as e,c as a,f as s}from"./app.ac77cf73.js";const t={},o=s(`<h1 id="using-global-properties-for-tdbgrideh" tabindex="-1"><a class="header-anchor" href="#using-global-properties-for-tdbgrideh" aria-hidden="true">#</a> Using global properties for TDBGridEh</h1><p>The Library has a set of global properties and event, which influence all grids that are created in the project. You can adjust this properties or event, for instance, in the main Form of your project, and all grids of the project will change its behaviors according to these properties. To control the global behavior of grids there are global objects such as the <code>TDBGridEhCenter</code> and <code>TDBGridEhStyle</code> type. The First one is used to control the behavior of the grids, the second one is to control the style of grids showing.</p><h3 id="general-information-about-tdbgridehcenter-class" tabindex="-1"><a class="header-anchor" href="#general-information-about-tdbgridehcenter-class" aria-hidden="true">#</a> General information about <code>TDBGridEhCenter</code> class:</h3><p>Use global function <code>DBGridEhCenter</code> to access the elements of the <code>TDBGridEhCenter</code> object:</p><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">function</span> DBGridEhCenter<span class="token punctuation">:</span> TDBGridEhCenter<span class="token punctuation">;</span>
</code></pre></div><p>It returns the global object of the type <code>TDBGridEhCenter</code>, which controls the behavior of all grids. You may inherit <code>TDBGridEhCenter</code> class, rewrite virtual methods and register your object of managing using <code>SetDBGridEhCenter</code> function:</p><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">function</span> SetDBGridEhCenter<span class="token punctuation">(</span>NewGridCenter<span class="token punctuation">:</span> TDBGridEhCenter<span class="token punctuation">)</span><span class="token punctuation">:</span> TDBGridEhCenter<span class="token punctuation">;</span>
</code></pre></div><p>It set new object of management and returns the old object. The Old object, in most cases, is required to destroy.</p><p>Properties and events of the <code>TDBGridEhCenter</code> class:</p><p><strong>Properties:</strong></p><dd><p><code>property FilterEditCloseUpApplyFilter: Boolean;</code></p><dl><dd><p>Determines whether the <code>SubTitleFilter</code> will be applied right after choosing value from dropped down list or always need to press Enter key to apply filter.</p></dd></dl><p><code>property IndicatorTitleMenus: TDBGridEhStyleIndicatorTitleMenusEh;</code></p><dl><dd><p>Specifies the list of elements, which will be visible in IndicatorTitle of dropped down menu when <code>TDBGridEh.IndicatorTitle.UseGlobalMenu = True</code> and <code>TDBGridEh.IndicatorTitle.TitleButton = True</code>.</p><p><code>TDBGridEhStyleIndicatorTitleMenusEh</code> is a set which consists of following values itmVisibleColumnsEh - Display the menu item with list of columns, cliquing on which possible to show or hide column. <dl><dd><code>itmCut</code> - Display Cut menu item</dd></dl><dl><dd><code>itmCopy</code> - Display Copy menu item</dd></dl><dl><dd><code>itmPaste</code> - Display Paste menu item</dd></dl><dl><dd><code>itmDelete</code> - Display Delete menu item</dd></dl><dl><dd><code>itmSelectAll</code> - Display SelectAll menu item</dd></dl></p></dd></dl></dd><p><strong>Events:</strong></p><dd><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code>OnApplyFilter<span class="token punctuation">:</span> TNotifyEvent<span class="token punctuation">;</span>
</code></pre></div><dl><dd><p>This event is called when grid apply <code>SubTitleFilter</code>. <code>Sender</code> parameter is a grid that applies filter. In the handler of event you can call default handler - <code>DBGridEhCenter.DefaultApplyFilter</code>.</p></dd></dl><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code>OnApplySorting<span class="token punctuation">:</span> TNotifyEvent<span class="token punctuation">;</span>
</code></pre></div><dl><dd><p>This event is called when grid apply sorting. <code>Sender</code> parameter is a grid that applies sorting. In the event handler you can call default handler - <code>DBGridEhCenter.DefaultApplySorting</code>.</p></dd></dl><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code>OnBuildIndicatorTitleMenu<span class="token punctuation">:</span> TDBGridEhBuildIndicatorTitleMenu<span class="token punctuation">;</span>
</code></pre></div><dl><dd><p>This event occurs when grid forms the dropped down menu that appears when mouse is clicked on the upper left cell of grid. Event occurs if <code>TDBGridEh.IndicatorTitle.TitleButton</code> = <code>True</code>. Sender parameter is a grid in which <code>IndicatorTitle</code> button was pressed. <code>PopupMenu</code> parameter is a menu that will is displayed under cell. You can call default handler that build menu items by default: <code>DBGridEhCenter.DefaultBuildIndicatorTitleMenu(Grid, PopupMenu);</code> and then perform additional code, for instance, to add one more menu elements.</p><p>Below is an example that demonstrate how to add new menu item in list of IndicatorTitle menus:</p><div class="language-pascal line-numbers-mode" data-ext="pascal"><pre class="language-pascal"><code>
<span class="token comment">// Declare global menu item for printing the grid.</span>
<span class="token keyword">var</span>  DBGridEhPreviewIndicatorMenuItem<span class="token punctuation">:</span> TDBGridEhMenuItem<span class="token punctuation">;</span>

<span class="token comment">// In public section of main Form declare methods for </span>
<span class="token comment">// OnBuildIndicatorTitleMenu event.</span>
    <span class="token keyword">procedure</span> BuildIndicatorTitleMenu<span class="token punctuation">(</span>Grid<span class="token punctuation">:</span> TCustomDBGridEh<span class="token punctuation">;</span> 
    <span class="token keyword">var</span> PopupMenu<span class="token punctuation">:</span> TPopupMenu<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Event procedure that will be call when menu item is selected.</span>
    <span class="token keyword">procedure</span> MenuEditClick<span class="token punctuation">(</span>Sender<span class="token punctuation">:</span> TObject<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// In TMainForm.OnCreate event of the program, assign the event on that will </span>
<span class="token comment">// be form IndicatorTitle menu items.</span>
<span class="token keyword">procedure</span> TForm1<span class="token punctuation">.</span>FormCreate<span class="token punctuation">(</span>Sender<span class="token punctuation">:</span> TObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>
  DBGridEhCenter<span class="token punctuation">.</span>OnBuildIndicatorTitleMenu <span class="token operator">:=</span> BuildIndicatorTitleMenu<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span> 

<span class="token comment">// Method Itself.</span>
<span class="token keyword">procedure</span> TForm1<span class="token punctuation">.</span>BuildIndicatorTitleMenu<span class="token punctuation">(</span>Grid<span class="token punctuation">:</span> TCustomDBGridEh<span class="token punctuation">;</span> 
  <span class="token keyword">var</span> PopupMenu<span class="token punctuation">:</span> TPopupMenu<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>
<span class="token comment">// At first it calls the default method of menu building.</span>
  DBGridEhCenter<span class="token punctuation">.</span>DefaultBuildIndicatorTitleMenu<span class="token punctuation">(</span>Grid<span class="token punctuation">,</span> PopupMenu<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Then create new item. </span>
  <span class="token keyword">if</span> DBGridEhPreviewIndicatorMenuItem <span class="token operator">=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
    DBGridEhPreviewIndicatorMenuItem <span class="token operator">:=</span> TDBGridEhMenuItem<span class="token punctuation">.</span>Create<span class="token punctuation">(</span>Screen<span class="token punctuation">)</span><span class="token punctuation">;</span>
  DBGridEhPreviewIndicatorMenuItem<span class="token punctuation">.</span>Caption <span class="token operator">:=</span> <span class="token string">&#39;Preview&#39;</span><span class="token punctuation">;</span>
  DBGridEhPreviewIndicatorMenuItem<span class="token punctuation">.</span>OnClick <span class="token operator">:=</span> MenuEditClick<span class="token punctuation">;</span>
  DBGridEhPreviewIndicatorMenuItem<span class="token punctuation">.</span>Enabled <span class="token operator">:=</span> <span class="token keyword">True</span><span class="token punctuation">;</span>
  DBGridEhPreviewIndicatorMenuItem<span class="token punctuation">.</span>Grid <span class="token operator">:=</span> Grid<span class="token punctuation">;</span>

<span class="token comment">// And add it at the end of the menu list.</span>
PopupMenu<span class="token punctuation">.</span>Items<span class="token punctuation">.</span>Insert<span class="token punctuation">(</span>
  PopupMenu<span class="token punctuation">.</span>Items<span class="token punctuation">.</span>IndexOf<span class="token punctuation">(</span>DBGridEhSelectAllIndicatorMenuItem<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> 
                          DBGridEhPreviewIndicatorMenuItem<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token comment">// The Handler of new menu item.</span>
<span class="token keyword">procedure</span> TForm1<span class="token punctuation">.</span>MenuEditClick<span class="token punctuation">(</span>Sender<span class="token punctuation">:</span> TObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>
  PrintDBGridEh1<span class="token punctuation">.</span>DBGridEh <span class="token operator">:=</span> TDBGridEh<span class="token punctuation">(</span>TDBGridEhMenuItem<span class="token punctuation">(</span>Sender<span class="token punctuation">)</span><span class="token punctuation">.</span>Grid<span class="token punctuation">)</span><span class="token punctuation">;</span>
  PrintDBGridEh1<span class="token punctuation">.</span>SetSubstitutes<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;%[Today]&#39;</span><span class="token punctuation">,</span>DateToStr<span class="token punctuation">(</span>Now<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  PrintDBGridEh1<span class="token punctuation">.</span>Preview<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><br><br></dd></dl><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">property</span> OnCellMouseClick<span class="token punctuation">:</span> TGridEhCellMouseEvent<span class="token punctuation">;</span>
   <span class="token keyword">type</span>  TGridEhCellMouseEvent <span class="token operator">=</span> <span class="token keyword">procedure</span> <span class="token punctuation">(</span>Grid<span class="token punctuation">:</span> TCustomGridEh<span class="token punctuation">;</span> Cell<span class="token punctuation">:</span> TGridCoord<span class="token punctuation">;</span>
    Button<span class="token punctuation">:</span> TMouseButton<span class="token punctuation">;</span> Shift<span class="token punctuation">:</span> TShiftState<span class="token punctuation">;</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">:</span> Integer<span class="token punctuation">)</span> <span class="token keyword">of</span> <span class="token keyword">object</span><span class="token punctuation">;</span>
</code></pre></div><dl><dd> This event occurs on mouse clicking in any cell of the grid. Event has such parameters: Grid; coordinates of the cell (Cell); Button, which was pressed on mouse (Button); Shift state of keyboard (Shift) and coordinates of the clicked point inside cell (X, Y). In the handler of event you can call the default handler - DBGridEhCenter.DefaultCellMouseClick. </dd></dl><br><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">property</span> OnIndicatorTitleMouseDown<span class="token punctuation">:</span> TGridEhCellMouseEvent<span class="token punctuation">;</span>
   <span class="token keyword">type</span>  TGridEhCellMouseEvent <span class="token operator">=</span> <span class="token keyword">procedure</span> <span class="token punctuation">(</span>Grid<span class="token punctuation">:</span> TCustomGridEh<span class="token punctuation">;</span> Cell<span class="token punctuation">:</span> TGridCoord<span class="token punctuation">;</span>
    Button<span class="token punctuation">:</span> TMouseButton<span class="token punctuation">;</span> Shift<span class="token punctuation">:</span> TShiftState<span class="token punctuation">;</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">:</span> Integer<span class="token punctuation">)</span> <span class="token keyword">of</span> <span class="token keyword">object</span><span class="token punctuation">;</span>
</code></pre></div><dl><dd> This event occurs when the mouse click on upper left cell of the grid occurs. In the handler of event you can call default handler - DBGridEhCenter.DefaultIndicatorTitleMouseDown. </dd></dl><br><div class="language-pascal" data-ext="pascal"><pre class="language-pascal"><code><span class="token keyword">property</span> OnLocateText<span class="token punctuation">:</span> TLocateTextEventEh<span class="token punctuation">;</span>
<span class="token keyword">type</span>  TLocateTextEventEh <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Sender<span class="token punctuation">:</span> TObject<span class="token punctuation">;</span>
  <span class="token keyword">const</span> FieldName<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span> 
  <span class="token keyword">const</span> Text<span class="token punctuation">:</span> <span class="token keyword">String</span><span class="token punctuation">;</span> Options<span class="token punctuation">:</span> 
  TLocateTextOptionsEh<span class="token punctuation">;</span> Direction<span class="token punctuation">:</span> 
  TLocateTextDirectionEh<span class="token punctuation">;</span> Matching<span class="token punctuation">:</span> TLocateTextMatchingEh<span class="token punctuation">;</span> 
  TreeFindRange<span class="token punctuation">:</span> TLocateTextTreeFindRangeEh<span class="token punctuation">)</span><span class="token punctuation">:</span> Boolean <span class="token keyword">of</span> <span class="token keyword">object</span><span class="token punctuation">;</span>
</code></pre></div><dl><dd> This event occurs during increment or dialogue searching in the grid. </dd></dl><br></dd><h3 id="the-general-information-about-tdbgridehstyle-class" tabindex="-1"><a class="header-anchor" href="#the-general-information-about-tdbgridehstyle-class" aria-hidden="true">#</a> The General information about <code>TDBGridEhStyle</code> class</h3><p>To access elements the global <code>DBGridEhStyle</code> object use function:</p><p><code>function DBGridEhStyle: TDBGridEhStyle;</code></p><dl><dd> It returns the current object of the type TDBGridEhStyle, which controls imaging of all grids. You can inherit TDBGridEhStyle, overwrite virtual methods controlling image of the grid, and register new object to manage, using next function: </dd></dl><p><code>function SetDBGridEhStyle(NewGridStyle: TDBGridEhStyle): TDBGridEhStyle;</code></p><dl><dd> Call this function to set new object of image controlling. It returns old object. In most cases it is necessary to delete old object. </dd></dl><br><p>Properties of the <code>TDBGridEhStyle</code> class:</p><p><code>property LuminateSelection: Boolean default True;</code></p><dl><dd><p>This property determines whether need to illuminate the selected area in grid. If <code>LuminateSelection = False</code> then the selected area will be painted by <code>clHighlight</code> color. If <code>LuminateSelection = True</code> then selected area will be painted by method as if you see on the area through the transparent glass of the <code>clHighlight</code> color.</p></dd></dl><p><code>property IsDrawFocusRect: Boolean default True;</code></p><dl><dd> This property determines whether to draw pointed square around the current cell or row in the grid. </dd></dl>`,25),p=[o];function c(i,l){return e(),a("div",null,p)}const u=n(t,[["render",c],["__file","42-using-global-properties-for-grid.html.vue"]]);export{u as default};
