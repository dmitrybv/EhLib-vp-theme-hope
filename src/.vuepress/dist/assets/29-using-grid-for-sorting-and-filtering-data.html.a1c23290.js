import{_ as t}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as e,c as o,f as d}from"./app.ac77cf73.js";const r={},a=d(`<h1 id="using-dbgrideh-for-sorting-and-filtering-data-in-the-dataset" tabindex="-1"><a class="header-anchor" href="#using-dbgrideh-for-sorting-and-filtering-data-in-the-dataset" aria-hidden="true">#</a> Using DBGridEh for sorting and filtering data in the DataSet</h1><p><code>DBGridEh</code> can not sort or filter data by itself. But it can pass action for sorting or filtering to the special object that will do it in <code>DataSet</code>. You can adjust grid for two types of sorting (local or server), using property <code>SortLocal</code> and two type of filtering (also, local and server), but real possibility to apply each type of operation depends on the type of <code>DataSet</code>. For instance, <code>TBDEDataSet</code> does not suppot sorting locally (inside DataSet). so you can not sort data locally when grid is linked to <code>TQuery</code> or <code>TTable</code>. Furthermore, <code>EhLib</code> has only special objects for standard types of <code>DataSet</code> (not for a third party DataSet&#39;s).</p><p>Below you can see a table of special object and <code>DataSet</code> in which those objects can sort or filter data.</p><table><thead><tr><th>Unit</th><th>DataSet</th><th>Local sorting</th><th>Server sorting</th><th>Local filtering</th><th>Server filtering</th></tr></thead><tbody><tr><td>EhLibBDE</td><td>TQuery, TTable</td><td>N</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>EhLibADO</td><td>TADOQuery,TADODataSet</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>EhLibCDS</td><td>TClientDataSet</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>EhLibDBX</td><td>TSQLQuery, TSQLDataSet</td><td>N</td><td>Y</td><td>N</td><td>Y</td></tr><tr><td>EhLibIBX</td><td>TIBQuery, TIBDataSet</td><td>N</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>EhLibMTE</td><td>TMemTableEh</td><td>Y</td><td>Y*</td><td>Y</td><td>Y*</td></tr></tbody></table><p><code>*</code> If Grid is configured for Server sorting of Filtering (SortLocal=False, STFilter.Local=False), then sort operation is transferred to the TMemTableEh.DataDriver object.</p><p>When grid is adjusted for a local filtering, the special object will build expression and assign it to a property Filter of DataSet. So we need also to set Filtered to True value manually. When grid is adjusted for a server filtering, the special object will build SQL: ORDER BY expression and it will replace ORDER BY string in SQL or Command property of DataSet and it will reopen DataSet. When grid is adjusted for a local sorting, the special object will perform a sorting using specific type of DataSet.</p><p>When the grid is adjusted for a server sorting, the special object will build expression for SQL <code>WHERE</code> clause in SQL string of dataset. It will try to find string that begins from key string <code>/*Filter*/</code> in SQL expression and adds filter expression after this string in same line (You can change this key string using global variable - SQLFilterMarker). So your SQL query must have a line that begins from <code>/*Filter*/</code>. For instance:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>select * 
from table1
where
/*Filter*/ 1=1 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>For automatically filtering/sorting data in dataset you need to add one of the units <code>EhLibXXX</code> (<code>EhLibADO</code>, <code>EhLibBDE</code>, <code>EhLibCDS</code> ... depend on the type of dataset where the grid is linked to) to <code>uses</code> clause of any unit of your project.</p><p>This units have code to register <code>TDatasetFeaturesEh</code> based classes (special object) for respective DataSet&#39;s. For other third party DataSet&#39;s you have to write and register your own special object or you have to write <code>OnApplyFilter</code> or/and <code>OnSortMarkingChanged</code> events for every required grid. Moreover, you can write <code>OnApplySorting</code> and/or <code>OnApplyFilter</code> for the global variable <code>DBGridEhDataService</code>. These events have <code>TNotifyEvent</code> type where Sender is <code>TCustomDBGridEh</code>.</p><p>In <code>C ++ Builder</code> projects to connect <code>EhLibXXX</code> module you need to add <code>EhLibXXX.pas</code> module to the project using <code>IDE menu -&gt; Project-&gt; Add to Project</code>.</p>`,11),i=[a];function n(s,c){return e(),o("div",null,i)}const p=t(r,[["render",n],["__file","29-using-grid-for-sorting-and-filtering-data.html.vue"]]);export{p as default};
